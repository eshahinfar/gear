<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multilingual Gearbox & Shaft Design System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .lang-btn.active {
            background: white;
            color: #2c3e50;
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .tab-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }
        
        .tab {
            flex: 1;
            padding: 18px 25px;
            text-align: center;
            cursor: pointer;
            background-color: #f8fafc;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
            color: #64748b;
        }
        
        .tab:hover {
            background-color: #f1f5f9;
            color: #4a6491;
        }
        
        .tab.active {
            background-color: white;
            color: #4a6491;
            border-bottom: 3px solid #4a6491;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .two-column {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .column {
            flex: 1;
        }
        
        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4a6491;
        }
        
        h3 {
            color: #3a506b;
            margin: 20px 0 15px 0;
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #3a506b;
        }
        
        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d9e6;
            border-radius: 6px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #4a6491;
            box-shadow: 0 0 0 2px rgba(74, 100, 145, 0.2);
        }
        
        .input-with-unit {
            display: flex;
            align-items: center;
        }
        
        .input-with-unit input {
            flex: 1;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        .unit {
            background-color: #f1f5f9;
            padding: 12px 15px;
            border: 1px solid #d1d9e6;
            border-left: none;
            border-top-right-radius: 6px;
            border-bottom-right-radius: 6px;
            color: #64748b;
            font-weight: 500;
        }
        
        .gear-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px;
            background-color: #f8fafc;
        }
        
        .gear-item {
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .gear-item-header {
            background-color: #4a6491;
            color: white;
            font-weight: bold;
        }
        
        .gear-info {
            flex: 1;
        }
        
        .gear-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .gear-specs {
            font-size: 0.9rem;
            color: #64748b;
        }
        
        .gear-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .edit-btn {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .delete-btn {
            background-color: #ffebee;
            color: #d32f2f;
        }
        
        .add-gear-btn {
            background-color: #4a6491;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            transition: background-color 0.3s;
        }
        
        .add-gear-btn:hover {
            background-color: #3a547a;
        }
        
        .gear-visualization {
            height: 400px;
            border: 1px solid #e1e5eb;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f9fafc;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .result-box {
            background-color: #f8fafc;
            border-left: 4px solid #4a6491;
            padding: 15px;
            border-radius: 6px;
        }
        
        .result-label {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 5px;
        }
        
        .result-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .result-unit {
            font-size: 0.9rem;
            color: #64748b;
            margin-left: 3px;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        button {
            padding: 15px 25px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .calculate-btn {
            background-color: #4a6491;
            color: white;
        }
        
        .calculate-btn:hover {
            background-color: #3a547a;
        }
        
        .reset-btn {
            background-color: #f1f5f9;
            color: #64748b;
        }
        
        .reset-btn:hover {
            background-color: #e2e8f0;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #64748b;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .shaft-section {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .shaft-gearbox-panel {
            background: linear-gradient(135deg, #edf2ff 0%, #f8fafc 100%);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #dce5f5;
            margin-bottom: 20px;
            box-shadow: 0 6px 18px rgba(30, 64, 175, 0.08);
        }

        .shaft-panel-header {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
        }

        .shaft-panel-header h3 {
            margin: 0;
            color: #1e3a8a;
        }

        .shaft-panel-tag {
            background-color: #1d4ed8;
            color: white;
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .shaft-panel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .shaft-panel-card {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #e2e8f0;
        }

        .shaft-panel-card h4 {
            margin-bottom: 8px;
            color: #1f2937;
            font-size: 1rem;
        }

        .shaft-panel-card p {
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .shaft-panel-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .shaft-panel-list li {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            font-size: 0.85rem;
            color: #475569;
            margin-bottom: 6px;
        }

        .shaft-panel-list i {
            color: #2563eb;
            margin-top: 2px;
        }

        .shaft-compliance {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            margin: 15px 0;
        }

        .shaft-compliance h4 {
            margin-bottom: 10px;
            color: #1e3a8a;
        }

        .compliance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .compliance-item:last-child {
            border-bottom: none;
        }

        .compliance-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            color: #0f766e;
        }

        .compliance-status.warning {
            color: #b45309;
        }
        
        .shaft-visualization {
            height: 300px;
            border: 1px solid #e1e5eb;
            border-radius: 8px;
            margin-top: 20px;
            position: relative;
            background-color: #f9fafc;
            overflow: hidden;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #64748b;
        }
        
        .gear-config {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .shaft-config {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .material-specs {
            background-color: #fff0f6;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #e64980;
        }
        
        .material-props {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .material-prop {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f1f3f5;
        }
        
        .prop-name {
            color: #495057;
            font-weight: 500;
        }
        
        .prop-value {
            color: #2c3e50;
            font-weight: 600;
        }
        
        .service-factors {
            background-color: #e6fcf5;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #20c997;
        }
        
        .service-factor-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 10px;
        }
        
        .factor-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .factor-name {
            color: #495057;
            font-size: 0.9rem;
        }
        
        .factor-value {
            font-weight: 600;
            color: #2c3e50;
            min-width: 60px;
            text-align: right;
        }
        
        .total-factor {
            background-color: #20c997;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
        }
        
        .gearbox-service-factors {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #1976d2;
        }
        
        @media (max-width: 1200px) {
            .two-column {
                flex-direction: column;
            }
            
            .gear-config, .shaft-config, .material-props, .service-factor-grid {
                grid-template-columns: 1fr;
            }

            .shaft-panel-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .language-selector {
                position: relative;
                top: 0;
                right: 0;
                justify-content: center;
                margin-bottom: 15px;
            }
        }
        
        .gear-stage {
            background-color: #f0f7ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #4a6491;
        }
        
        .stage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .stage-title {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1rem;
        }
        
        .stage-ratio {
            background-color: #4a6491;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .gear-pair {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 15px 0;
        }
        
        .gear-pair-item {
            text-align: center;
            flex: 1;
        }
        
        .gear-icon {
            font-size: 40px;
            color: #4a6491;
            margin-bottom: 10px;
        }
        
        .shaft-diagram {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #64748b;
        }
        
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 12px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 12px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .material-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .material-option {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            text-align: center;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .material-option:hover {
            border-color: #4a6491;
            background-color: #f8fafc;
        }
        
        .material-option.active {
            border-color: #4a6491;
            background-color: #4a6491;
            color: white;
        }
        
        .custom-material-btn {
            background-color: #f1f5f9;
            border: 2px dashed #cbd5e1;
            color: #64748b;
        }
        
        .custom-material-btn:hover {
            border-color: #94a3b8;
            background-color: #e2e8f0;
        }
        
        .custom-material-section {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border: 1px dashed #cbd5e1;
        }
        
        .stress-results {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .stress-item {
            background-color: #f8fafc;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }
        
        .stress-label {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 8px;
        }
        
        .stress-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .stress-unit {
            font-size: 0.9rem;
            color: #64748b;
            margin-left: 3px;
        }
        
        .stress-bar {
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .stress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .safe {
            background-color: #20c997;
        }
        
        .warning-level {
            background-color: #ffc107;
        }
        
        .critical {
            background-color: #dc3545;
        }
        
        .toggle-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            background-color: #f8fafc;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .toggle-icon {
            transition: transform 0.3s;
        }
        
        .toggle-section.collapsed .toggle-icon {
            transform: rotate(180deg);
        }
        
        .toggle-content {
            max-height: 1000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .toggle-content.collapsed {
            max-height: 0;
        }
        
        .multilingual-icon {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector">
                <button class="lang-btn active" data-lang="en">
                    <i class="fas fa-globe multilingual-icon"></i>English
                </button>
                <button class="lang-btn" data-lang="de">
                    <i class="fas fa-globe multilingual-icon"></i>Deutsch
                </button>
            </div>
            
            <h1 id="header-title"><i class="fas fa-cogs"></i> Multilingual Gearbox & Shaft Design System</h1>
            <p id="header-description">Design complete gear systems with material specifications and service factors</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="single-gear" data-i18n="tab.single-gear">Single Gear Design</div>
            <div class="tab" data-tab="gearbox" data-i18n="tab.gearbox">Gearbox Design</div>
            <div class="tab" data-tab="shaft" data-i18n="tab.shaft">Shaft Design</div>
            <div class="tab" data-tab="analysis" data-i18n="tab.analysis">System Analysis</div>
        </div>
        
        <!-- Single Gear Design Tab -->
        <div class="tab-content active" id="single-gear">
            <div class="two-column">
                <div class="column">
                    <h2 data-i18n="single-gear.title">Gear Parameters</h2>
                    
                    <div class="form-group">
                        <label for="gear-type" data-i18n="single-gear.gear-type">Gear Type</label>
                        <select id="gear-type">
                            <option value="spur" data-i18n="gear-type.spur">Spur Gear</option>
                            <option value="helical" data-i18n="gear-type.helical">Helical Gear</option>
                            <option value="bevel" data-i18n="gear-type.bevel">Bevel Gear</option>
                            <option value="worm" data-i18n="gear-type.worm">Worm Gear</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="module" data-i18n="single-gear.module">Module (m)</label>
                        <div class="input-with-unit">
                            <input type="number" id="module" min="0.5" max="20" step="0.5" value="3">
                            <div class="unit" data-i18n="unit.mm">mm</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="teeth" data-i18n="single-gear.teeth">Number of Teeth (z)</label>
                        <input type="number" id="teeth" min="8" max="200" value="24">
                    </div>
                    
                    <div class="form-group">
                        <label for="pressure-angle" data-i18n="single-gear.pressure-angle">Pressure Angle (α)</label>
                        <div class="input-with-unit">
                            <select id="pressure-angle">
                                <option value="14.5" data-i18n="pressure-angle.14_5">14.5° (Old Standard)</option>
                                <option value="20" selected data-i18n="pressure-angle.20">20° (Most Common)</option>
                                <option value="25" data-i18n="pressure-angle.25">25° (High Load)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="face-width" data-i18n="single-gear.face-width">Face Width (b)</label>
                        <div class="input-with-unit">
                            <input type="number" id="face-width" min="5" max="200" value="25">
                            <div class="unit" data-i18n="unit.mm">mm</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="rpm" data-i18n="single-gear.rpm">Input Speed</label>
                        <div class="input-with-unit">
                            <input type="number" id="rpm" min="10" max="10000" value="1200">
                            <div class="unit" data-i18n="unit.rpm">RPM</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="power" data-i18n="single-gear.power">Input Power</label>
                        <div class="input-with-unit">
                            <input type="number" id="power" min="0.1" max="1000" step="0.1" value="7.5">
                            <div class="unit" data-i18n="unit.kw">kW</div>
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="calculate-btn" id="calculate-single">
                            <i class="fas fa-calculator"></i> <span data-i18n="button.calculate">Calculate Gear</span>
                        </button>
                        <button class="reset-btn" id="reset-single">
                            <i class="fas fa-redo"></i> <span data-i18n="button.reset">Reset</span>
                        </button>
                        <button class="reset-btn" id="export-gear-stp">
                            <i class="fas fa-file-export"></i> <span data-i18n="button.export-stp">Export Gear (.stp)</span>
                        </button>
                    </div>
                </div>
                
                <div class="column">
                    <h2 data-i18n="single-gear.results">Gear Results</h2>
                    
                    <div class="gear-visualization">
                        <canvas id="single-gear-canvas" width="500" height="350"></canvas>
                    </div>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.pitch-diameter">Pitch Diameter</div>
                            <div class="result-value" id="pitch-diameter">72.00<span class="result-unit" data-i18n="unit.mm">mm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.outer-diameter">Outer Diameter</div>
                            <div class="result-value" id="outer-diameter">78.00<span class="result-unit" data-i18n="unit.mm">mm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.tangential-force">Tangential Force</div>
                            <div class="result-value" id="tangential-force">1061.0<span class="result-unit" data-i18n="unit.n">N</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.torque">Torque</div>
                            <div class="result-value" id="torque">59.72<span class="result-unit" data-i18n="unit.nm">Nm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.circular-pitch">Circular Pitch</div>
                            <div class="result-value" id="circular-pitch">9.42<span class="result-unit" data-i18n="unit.mm">mm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.contact-ratio">Contact Ratio</div>
                            <div class="result-value" id="contact-ratio">1.67<span class="result-unit"></span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.bending-stress">Bending Stress</div>
                            <div class="result-value" id="bending-stress">85.3<span class="result-unit" data-i18n="unit.mpa">MPa</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.safety-factor">Safety Factor</div>
                            <div class="result-value" id="safety-factor">2.4<span class="result-unit"></span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Gearbox Design Tab -->
        <div class="tab-content" id="gearbox">
            <div class="two-column">
                <div class="column">
                    <h2 data-i18n="gearbox.title">Gearbox Configuration</h2>
                    
                    <div class="form-group">
                        <label for="gearbox-type" data-i18n="gearbox.type">Gearbox Type</label>
                        <select id="gearbox-type">
                            <option value="parallel" data-i18n="gearbox-type.parallel">Parallel Shaft</option>
                            <option value="planetary" data-i18n="gearbox-type.planetary">Planetary Gearset</option>
                            <option value="worm" data-i18n="gearbox-type.worm">Worm Gearbox</option>
                            <option value="bevel" data-i18n="gearbox-type.bevel">Bevel Gearbox</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="num-stages" data-i18n="gearbox.stages">Number of Stages</label>
                        <select id="num-stages">
                            <option value="1" data-i18n="gearbox.stages-1">1 Stage</option>
                            <option value="2" selected data-i18n="gearbox.stages-2">2 Stages</option>
                            <option value="3" data-i18n="gearbox.stages-3">3 Stages</option>
                            <option value="4" data-i18n="gearbox.stages-4">4 Stages</option>
                        </select>
                    </div>
                    
                    <div class="gearbox-service-factors">
                        <h4 data-i18n="gearbox.service-factors">Gearbox Service Factors</h4>
                        <div class="service-factor-grid">
                            <div class="factor-item">
                                <span class="factor-name" data-i18n="service.load-type">Load Type Factor</span>
                                <select id="gearbox-load-type" class="factor-value">
                                    <option value="1.0" data-i18n="service.load-uniform">Uniform (1.0)</option>
                                    <option value="1.25" selected data-i18n="service.load-moderate">Moderate Shock (1.25)</option>
                                    <option value="1.5" data-i18n="service.load-heavy">Heavy Shock (1.5)</option>
                                </select>
                            </div>
                            
                            <div class="factor-item">
                                <span class="factor-name" data-i18n="service.duty-cycle">Duty Cycle Factor</span>
                                <select id="gearbox-duty-cycle" class="factor-value">
                                    <option value="1.0" data-i18n="service.duty-continuous">Continuous (1.0)</option>
                                    <option value="1.1" data-i18n="service.duty-8h">8-10 hours/day (1.1)</option>
                                    <option value="1.25" selected data-i18n="service.duty-intermittent">Intermittent (1.25)</option>
                                </select>
                            </div>
                            
                            <div class="factor-item">
                                <span class="factor-name" data-i18n="service.reliability">Reliability Factor</span>
                                <select id="gearbox-reliability" class="factor-value">
                                    <option value="1.0" data-i18n="service.reliability-90">90% (1.0)</option>
                                    <option value="1.1" data-i18n="service.reliability-95">95% (1.1)</option>
                                    <option value="1.25" selected data-i18n="service.reliability-99">99% (1.25)</option>
                                </select>
                            </div>
                            
                            <div class="factor-item">
                                <span class="factor-name" data-i18n="service.temperature">Temperature Factor</span>
                                <select id="gearbox-temperature" class="factor-value">
                                    <option value="1.0" selected data-i18n="service.temp-below120">Below 120°C (1.0)</option>
                                    <option value="1.1" data-i18n="service.temp-120-200">120-200°C (1.1)</option>
                                    <option value="1.25" data-i18n="service.temp-200-300">200-300°C (1.25)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="total-factor">
                            <span data-i18n="service.total-factor">Total Service Factor (K)</span> = <span id="gearbox-total-factor">1.95</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="input-rpm" data-i18n="gearbox.input-rpm">Input Speed</label>
                        <div class="input-with-unit">
                            <input type="number" id="input-rpm" min="10" max="10000" value="1500">
                            <div class="unit" data-i18n="unit.rpm">RPM</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="input-power" data-i18n="gearbox.input-power">Input Power</label>
                        <div class="input-with-unit">
                            <input type="number" id="input-power" min="0.1" max="1000" step="0.1" value="10">
                            <div class="unit" data-i18n="unit.kw">kW</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="total-ratio" data-i18n="gearbox.total-ratio">Total Gear Ratio</label>
                        <div class="input-with-unit">
                            <input type="number" id="total-ratio" min="1" max="1000" step="0.1" value="12.5">
                            <div class="unit" data-i18n="unit.ratio">:1</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="module-gearbox" data-i18n="gearbox.module">Module (Common)</label>
                        <div class="input-with-unit">
                            <input type="number" id="module-gearbox" min="0.5" max="20" step="0.5" value="2.5">
                            <div class="unit" data-i18n="unit.mm">mm</div>
                        </div>
                    </div>
                    
                    <button class="add-gear-btn" id="add-gear-stage">
                        <i class="fas fa-plus-circle"></i> <span data-i18n="button.add-stage">Add Gear Stage</span>
                    </button>
                    
                    <h3 data-i18n="gearbox.stage-list">Gear Stages</h3>
                    <div class="gear-list" id="gearbox-stages">
                        <!-- Gear stages will be added here dynamically -->
                        <div class="gear-item gear-item-header">
                            <div class="gear-info" data-i18n="gearbox.stage">Stage</div>
                            <div class="gear-info" data-i18n="gearbox.ratio">Ratio</div>
                            <div class="gear-info" data-i18n="gearbox.gears">Gear 1 / Gear 2</div>
                            <div class="gear-actions" data-i18n="gearbox.actions">Actions</div>
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="calculate-btn" id="calculate-gearbox">
                            <i class="fas fa-cogs"></i> <span data-i18n="button.calculate-gearbox">Calculate Gearbox</span>
                        </button>
                        <button class="reset-btn" id="reset-gearbox">
                            <i class="fas fa-redo"></i> <span data-i18n="button.reset-gearbox">Reset Gearbox</span>
                        </button>
                    </div>
                </div>
                
                <div class="column">
                    <h2 data-i18n="gearbox.results">Gearbox Results</h2>
                    
                    <div class="gear-visualization">
                        <canvas id="gearbox-canvas" width="500" height="350"></canvas>
                    </div>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.output-rpm">Output Speed</div>
                            <div class="result-value" id="output-rpm">120.0<span class="result-unit" data-i18n="unit.rpm">RPM</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.output-torque">Output Torque</div>
                            <div class="result-value" id="output-torque">795.8<span class="result-unit" data-i18n="unit.nm">Nm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.gearbox-efficiency">Total Efficiency</div>
                            <div class="result-value" id="gearbox-efficiency">94.5<span class="result-unit" data-i18n="unit.percent">%</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.power-loss">Power Loss</div>
                            <div class="result-value" id="power-loss">0.55<span class="result-unit" data-i18n="unit.kw">kW</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.center-distance">Center Distance</div>
                            <div class="result-value" id="center-distance">112.5<span class="result-unit" data-i18n="unit.mm">mm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.overall-size">Overall Size</div>
                            <div class="result-value" id="overall-size">450×300<span class="result-unit" data-i18n="unit.mm">mm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.gearbox-weight">Weight (Approx.)</div>
                            <div class="result-value" id="gearbox-weight">24.5<span class="result-unit" data-i18n="unit.kg">kg</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.heat-generated">Heat Generated</div>
                            <div class="result-value" id="heat-generated">475<span class="result-unit" data-i18n="unit.w">W</span></div>
                        </div>
                    </div>
                    
                    <h3 data-i18n="gearbox.stage-details">Gear Stage Details</h3>
                    <div id="stage-details">
                        <!-- Stage details will be added here -->
                        <div class="loading" data-i18n="message.calculate-to-see">Calculate gearbox to see stage details</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Shaft Design Tab -->
        <div class="tab-content" id="shaft">
            <div class="two-column">
                <div class="column">
                    <h2 data-i18n="shaft.title">Shaft Design Parameters</h2>

                    <div class="shaft-gearbox-panel">
                        <div class="shaft-panel-header">
                            <div>
                                <h3 data-i18n="shaft.gearbox-compliance">Gearbox Shaft Compliance</h3>
                                <p data-i18n="shaft.gearbox-compliance-desc">Design the shaft using gearbox output torque, speed, and mounting limits.</p>
                            </div>
                            <div class="shaft-panel-tag" data-i18n="shaft.gearbox-tag">Gearbox Driven</div>
                        </div>
                        <div class="shaft-panel-grid">
                            <div class="shaft-panel-card">
                                <h4 data-i18n="shaft.gearbox-inputs">Gearbox Inputs</h4>
                                <p data-i18n="shaft.gearbox-inputs-desc">Align applied torque and speed with gearbox results.</p>
                                <ul class="shaft-panel-list">
                                    <li><i class="fas fa-check-circle"></i><span data-i18n="shaft.gearbox-inputs-item1">Use service factor-adjusted torque</span></li>
                                    <li><i class="fas fa-check-circle"></i><span data-i18n="shaft.gearbox-inputs-item2">Match output speed for critical speed check</span></li>
                                </ul>
                            </div>
                            <div class="shaft-panel-card">
                                <h4 data-i18n="shaft.interface">Interface Fit</h4>
                                <p data-i18n="shaft.interface-desc">Confirm the shaft fits gearbox bore and key interface.</p>
                                <ul class="shaft-panel-list">
                                    <li><i class="fas fa-check-circle"></i><span data-i18n="shaft.interface-item1">Diameter & fit class within gearbox limits</span></li>
                                    <li><i class="fas fa-check-circle"></i><span data-i18n="shaft.interface-item2">Keyway or spline matches coupling</span></li>
                                </ul>
                            </div>
                            <div class="shaft-panel-card">
                                <h4 data-i18n="shaft.support">Support Layout</h4>
                                <p data-i18n="shaft.support-desc">Bearings and loads aligned to gearbox housing.</p>
                                <ul class="shaft-panel-list">
                                    <li><i class="fas fa-check-circle"></i><span data-i18n="shaft.support-item1">Bearing span within housing length</span></li>
                                    <li><i class="fas fa-check-circle"></i><span data-i18n="shaft.support-item2">Load points aligned with gear meshes</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Shaft Geometry Section -->
                    <div class="toggle-section" id="geometry-toggle">
                        <h3 data-i18n="shaft.geometry">Shaft Geometry</h3>
                        <i class="fas fa-chevron-up toggle-icon"></i>
                    </div>
                    <div class="toggle-content" id="geometry-content">
                        <div class="shaft-config">
                            <div class="form-group">
                                <label for="shaft-length" data-i18n="shaft.length">Shaft Length</label>
                                <div class="input-with-unit">
                                    <input type="number" id="shaft-length" min="50" max="5000" value="500">
                                    <div class="unit" data-i18n="unit.mm">mm</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="shaft-diameter" data-i18n="shaft.diameter">Base Diameter</label>
                                <div class="input-with-unit">
                                    <input type="number" id="shaft-diameter" min="10" max="500" value="40">
                                    <div class="unit" data-i18n="unit.mm">mm</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="shaft-taper" data-i18n="shaft.taper">Taper Ratio</label>
                                <div class="input-with-unit">
                                    <input type="number" id="shaft-taper" min="0" max="0.5" step="0.01" value="0.05">
                                    <div class="unit">d/L</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Gearbox Interface Section -->
                    <div class="toggle-section" id="interface-toggle">
                        <h3 data-i18n="shaft.gearbox-interface">Gearbox Interface & Fit</h3>
                        <i class="fas fa-chevron-up toggle-icon"></i>
                    </div>
                    <div class="toggle-content" id="interface-content">
                        <div class="shaft-config">
                            <div class="form-group">
                                <label for="gearbox-bore" data-i18n="shaft.gearbox-bore">Gearbox Output Bore</label>
                                <div class="input-with-unit">
                                    <input type="number" id="gearbox-bore" min="10" max="500" value="45">
                                    <div class="unit" data-i18n="unit.mm">mm</div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="hub-length" data-i18n="shaft.hub-length">Coupling Hub Length</label>
                                <div class="input-with-unit">
                                    <input type="number" id="hub-length" min="10" max="500" value="80">
                                    <div class="unit" data-i18n="unit.mm">mm</div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="fit-class" data-i18n="shaft.fit-class">Fit Class</label>
                                <select id="fit-class">
                                    <option value="h7" selected>H7/h6</option>
                                    <option value="k6">K6/h6</option>
                                    <option value="m6">M6/h6</option>
                                    <option value="p6">P6/h6</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="keyway-type" data-i18n="shaft.keyway">Keyway / Spline</label>
                                <select id="keyway-type">
                                    <option value="parallel" selected data-i18n="shaft.keyway-parallel">Parallel Key</option>
                                    <option value="woodruff" data-i18n="shaft.keyway-woodruff">Woodruff Key</option>
                                    <option value="spline" data-i18n="shaft.keyway-spline">Involute Spline</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="alignment" data-i18n="shaft.alignment">Alignment Target</label>
                                <select id="alignment">
                                    <option value="standard" selected data-i18n="shaft.alignment-standard">Standard (≤ 0.1 mm)</option>
                                    <option value="precision" data-i18n="shaft.alignment-precision">Precision (≤ 0.05 mm)</option>
                                    <option value="high" data-i18n="shaft.alignment-high">High Precision (≤ 0.02 mm)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Material Selection Section -->
                    <div class="toggle-section" id="material-toggle">
                        <h3 data-i18n="shaft.material">Material Specification</h3>
                        <i class="fas fa-chevron-up toggle-icon"></i>
                    </div>
                    <div class="toggle-content" id="material-content">
                        <div class="material-selector">
                            <div class="material-option active" data-material="steel-mild">
                                <i class="fas fa-industry"></i>
                                <div data-i18n="material.mild-steel">Mild Steel</div>
                            </div>
                            <div class="material-option" data-material="steel-alloy">
                                <i class="fas fa-cogs"></i>
                                <div data-i18n="material.alloy-steel">Alloy Steel</div>
                            </div>
                            <div class="material-option" data-material="steel-stainless">
                                <i class="fas fa-shield-alt"></i>
                                <div data-i18n="material.stainless-steel">Stainless Steel</div>
                            </div>
                            <div class="material-option" data-material="aluminum">
                                <i class="fas fa-weight"></i>
                                <div data-i18n="material.aluminum">Aluminum Alloy</div>
                            </div>
                            <div class="material-option custom-material-btn" id="custom-material">
                                <i class="fas fa-edit"></i>
                                <div data-i18n="material.custom">Custom</div>
                            </div>
                        </div>
                        
                        <div class="material-specs" id="material-specs">
                            <h4 data-i18n="material.properties">Material Properties</h4>
                            <div class="material-props">
                                <div class="material-prop">
                                    <span class="prop-name" data-i18n="material.yield-strength">Yield Strength (σ_y)</span>
                                    <span class="prop-value" id="yield-strength">250 MPa</span>
                                </div>
                                <div class="material-prop">
                                    <span class="prop-name" data-i18n="material.ultimate-strength">Ultimate Strength (σ_u)</span>
                                    <span class="prop-value" id="ultimate-strength">400 MPa</span>
                                </div>
                                <div class="material-prop">
                                    <span class="prop-name" data-i18n="material.shear-strength">Shear Strength (τ_max)</span>
                                    <span class="prop-value" id="shear-strength">145 MPa</span>
                                </div>
                                <div class="material-prop">
                                    <span class="prop-name" data-i18n="material.elastic-modulus">Modulus of Elasticity (E)</span>
                                    <span class="prop-value" id="elastic-modulus">210 GPa</span>
                                </div>
                                <div class="material-prop">
                                    <span class="prop-name" data-i18n="material.density">Density (ρ)</span>
                                    <span class="prop-value" id="material-density">7850 kg/m³</span>
                                </div>
                                <div class="material-prop">
                                    <span class="prop-name" data-i18n="material.poisson-ratio">Poisson's Ratio (ν)</span>
                                    <span class="prop-value" id="poisson-ratio">0.3</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="custom-material-section" id="custom-material-section" style="display: none;">
                            <h4 data-i18n="material.custom-properties">Custom Material Properties</h4>
                            <div class="shaft-config">
                                <div class="form-group">
                                    <label for="custom-yield" data-i18n="material.yield-strength">Yield Strength</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="custom-yield" min="50" max="2000" value="250">
                                        <div class="unit" data-i18n="unit.mpa">MPa</div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="custom-ultimate" data-i18n="material.ultimate-strength">Ultimate Strength</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="custom-ultimate" min="100" max="3000" value="400">
                                        <div class="unit" data-i18n="unit.mpa">MPa</div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="custom-shear" data-i18n="material.shear-strength">Shear Strength</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="custom-shear" min="30" max="1500" value="145">
                                        <div class="unit" data-i18n="unit.mpa">MPa</div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="custom-modulus" data-i18n="material.elastic-modulus">Elastic Modulus</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="custom-modulus" min="10" max="400" value="210">
                                        <div class="unit" data-i18n="unit.gpa">GPa</div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="custom-density" data-i18n="material.density">Density</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="custom-density" min="1000" max="20000" value="7850">
                                        <div class="unit" data-i18n="unit.kg-m3">kg/m³</div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="custom-poisson" data-i18n="material.poisson-ratio">Poisson's Ratio</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="custom-poisson" min="0.1" max="0.5" step="0.01" value="0.3">
                                        <div class="unit"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Service Factors Section -->
                    <div class="toggle-section" id="service-toggle">
                        <h3 data-i18n="shaft.service-factors">Service Factors & Load Conditions</h3>
                        <i class="fas fa-chevron-up toggle-icon"></i>
                    </div>
                    <div class="toggle-content" id="service-content">
                        <div class="service-factors">
                            <h4 data-i18n="service.application">Application Service Factors</h4>
                            <div class="service-factor-grid">
                                <div class="factor-item">
                                    <span class="factor-name" data-i18n="service.load-type">Load Type Factor (K_a)</span>
                                    <select id="load-type-factor" class="factor-value">
                                        <option value="1.0" data-i18n="service.load-uniform">Uniform (1.0)</option>
                                        <option value="1.25" selected data-i18n="service.load-moderate">Moderate Shock (1.25)</option>
                                        <option value="1.5" data-i18n="service.load-heavy">Heavy Shock (1.5)</option>
                                        <option value="1.75" data-i18n="service.load-severe">Severe Shock (1.75)</option>
                                    </select>
                                </div>
                                
                                <div class="factor-item">
                                    <span class="factor-name" data-i18n="service.duty-cycle">Duty Cycle Factor (K_b)</span>
                                    <select id="duty-cycle-factor" class="factor-value">
                                        <option value="1.0" data-i18n="service.duty-continuous">Continuous (1.0)</option>
                                        <option value="1.1" data-i18n="service.duty-8h">8-10 hours/day (1.1)</option>
                                        <option value="1.25" selected data-i18n="service.duty-intermittent">Intermittent (1.25)</option>
                                        <option value="1.5" data-i18n="service.duty-occasional">Occasional (1.5)</option>
                                    </select>
                                </div>
                                
                                <div class="factor-item">
                                    <span class="factor-name" data-i18n="service.reliability">Reliability Factor (K_c)</span>
                                    <select id="reliability-factor" class="factor-value">
                                        <option value="1.0" data-i18n="service.reliability-90">90% (1.0)</option>
                                        <option value="1.1" data-i18n="service.reliability-95">95% (1.1)</option>
                                        <option value="1.25" selected data-i18n="service.reliability-99">99% (1.25)</option>
                                        <option value="1.5" data-i18n="service.reliability-99_9">99.9% (1.5)</option>
                                    </select>
                                </div>
                                
                                <div class="factor-item">
                                    <span class="factor-name" data-i18n="service.temperature">Temperature Factor (K_d)</span>
                                    <select id="temperature-factor" class="factor-value">
                                        <option value="1.0" selected data-i18n="service.temp-below120">Below 120°C (1.0)</option>
                                        <option value="1.1" data-i18n="service.temp-120-200">120-200°C (1.1)</option>
                                        <option value="1.25" data-i18n="service.temp-200-300">200-300°C (1.25)</option>
                                        <option value="1.5" data-i18n="service.temp-above300">Above 300°C (1.5)</option>
                                    </select>
                                </div>
                                
                                <div class="factor-item">
                                    <span class="factor-name" data-i18n="service.surface-finish">Surface Finish Factor (K_e)</span>
                                    <select id="surface-factor" class="factor-value">
                                        <option value="1.0" data-i18n="service.surface-ground">Ground (1.0)</option>
                                        <option value="1.1" selected data-i18n="service.surface-machined">Machined (1.1)</option>
                                        <option value="1.25" data-i18n="service.surface-hot-rolled">Hot Rolled (1.25)</option>
                                        <option value="1.5" data-i18n="service.surface-forged">Forged (1.5)</option>
                                    </select>
                                </div>
                                
                                <div class="factor-item">
                                    <span class="factor-name" data-i18n="service.size">Size Factor (K_f)</span>
                                    <select id="size-factor" class="factor-value">
                                        <option value="1.0" selected data-i18n="service.size-50">d ≤ 50mm (1.0)</option>
                                        <option value="1.1" data-i18n="service.size-100">50-100mm (1.1)</option>
                                        <option value="1.25" data-i18n="service.size-200">100-200mm (1.25)</option>
                                        <option value="1.5" data-i18n="service.size-above200">>200mm (1.5)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="total-factor">
                                <span data-i18n="service.total-factor">Total Service Factor (K)</span> = <span id="total-service-factor">2.34</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="desired-safety" data-i18n="shaft.desired-safety">Desired Safety Factor</label>
                            <div class="input-with-unit">
                                <input type="number" id="desired-safety" min="1.0" max="10" step="0.1" value="2.5">
                                <div class="unit"></div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="shaft-torque" data-i18n="shaft.torque">Applied Torque</label>
                            <div class="input-with-unit">
                                <input type="number" id="shaft-torque" min="1" max="10000" value="200">
                                <div class="unit" data-i18n="unit.nm">Nm</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="shaft-speed" data-i18n="shaft.speed">Shaft Speed</label>
                            <div class="input-with-unit">
                                <input type="number" id="shaft-speed" min="10" max="10000" value="1200">
                                <div class="unit" data-i18n="unit.rpm">RPM</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="num-bearings" data-i18n="shaft.bearings">Number of Bearings</label>
                            <select id="num-bearings">
                                <option value="2" data-i18n="shaft.bearings-2">2 Bearings</option>
                                <option value="3" selected data-i18n="shaft.bearings-3">3 Bearings</option>
                                <option value="4" data-i18n="shaft.bearings-4">4 Bearings</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="num-loads" data-i18n="shaft.loads">Number of Load Points</label>
                            <select id="num-loads">
                                <option value="1" data-i18n="shaft.loads-1">1 Load</option>
                                <option value="2" selected data-i18n="shaft.loads-2">2 Loads</option>
                                <option value="3" data-i18n="shaft.loads-3">3 Loads</option>
                                <option value="4" data-i18n="shaft.loads-4">4 Loads</option>
                            </select>
                        </div>
                        
                        <button class="add-gear-btn" id="add-load-point">
                            <i class="fas fa-weight-hanging"></i> <span data-i18n="button.configure-loads">Configure Load Points</span>
                        </button>
                    </div>
                    
                    <div class="buttons">
                        <button class="calculate-btn" id="calculate-shaft">
                            <i class="fas fa-ruler"></i> <span data-i18n="button.calculate-shaft">Calculate Shaft</span>
                        </button>
                        <button class="reset-btn" id="reset-shaft">
                            <i class="fas fa-redo"></i> <span data-i18n="button.reset">Reset</span>
                        </button>
                    </div>
                </div>
                
                <div class="column">
                    <h2 data-i18n="shaft.results">Shaft Design Results</h2>
                    
                    <div class="shaft-visualization">
                        <canvas id="shaft-canvas" width="500" height="280"></canvas>
                    </div>

                    <div class="shaft-compliance">
                        <h4 data-i18n="shaft.compliance-check">Gearbox Compliance Check</h4>
                        <div class="compliance-item">
                            <span data-i18n="shaft.compliance-item1">Torque & service factor aligned with gearbox</span>
                            <span class="compliance-status"><i class="fas fa-check-circle"></i><span data-i18n="shaft.compliance-ok">OK</span></span>
                        </div>
                        <div class="compliance-item">
                            <span data-i18n="shaft.compliance-item2">Output bore & fit class validated</span>
                            <span class="compliance-status"><i class="fas fa-check-circle"></i><span data-i18n="shaft.compliance-ok">OK</span></span>
                        </div>
                        <div class="compliance-item">
                            <span data-i18n="shaft.compliance-item3">Bearing span within gearbox housing</span>
                            <span class="compliance-status warning"><i class="fas fa-triangle-exclamation"></i><span data-i18n="shaft.compliance-review">Review</span></span>
                        </div>
                    </div>
                    
                    <div class="stress-results">
                        <div class="stress-item">
                            <div class="stress-label" data-i18n="result.torsional-stress">Torsional Stress</div>
                            <div class="stress-value" id="torsional-stress">32.5<span class="stress-unit" data-i18n="unit.mpa">MPa</span></div>
                            <div class="stress-bar">
                                <div class="stress-fill safe" id="torsion-bar" style="width: 25%"></div>
                            </div>
                            <div class="stress-label" id="torsion-status" data-i18n="status.safe">Safe (25% of limit)</div>
                        </div>
                        
                        <div class="stress-item">
                            <div class="stress-label" data-i18n="result.bending-stress">Bending Stress</div>
                            <div class="stress-value" id="bending-stress">45.8<span class="stress-unit" data-i18n="unit.mpa">MPa</span></div>
                            <div class="stress-bar">
                                <div class="stress-fill safe" id="bending-bar" style="width: 38%"></div>
                            </div>
                            <div class="stress-label" id="bending-status" data-i18n="status.safe">Safe (38% of limit)</div>
                        </div>
                    </div>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.von-mises-stress">Von Mises Stress</div>
                            <div class="result-value" id="von-mises-stress">68.3<span class="result-unit" data-i18n="unit.mpa">MPa</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.max-deflection">Max Deflection</div>
                            <div class="result-value" id="max-deflection">0.12<span class="result-unit" data-i18n="unit.mm">mm</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.critical-speed">Critical Speed</div>
                            <div class="result-value" id="critical-speed">4250<span class="result-unit" data-i18n="unit.rpm">RPM</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.torsional-stiffness">Torsional Stiffness</div>
                            <div class="result-value" id="torsional-stiffness">18500<span class="result-unit" data-i18n="unit.nm-rad">Nm/rad</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.sf-static">Safety Factor (Static)</div>
                            <div class="result-value" id="sf-static">3.2<span class="result-unit"></span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.sf-fatigue">Safety Factor (Fatigue)</div>
                            <div class="result-value" id="sf-fatigue">2.8<span class="result-unit"></span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.applied-service-factor">Service Factor Applied</div>
                            <div class="result-value" id="applied-service-factor">2.34<span class="result-unit"></span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.overall-rating">Overall Rating</div>
                            <div class="result-value" id="overall-rating">Good<span class="result-unit"></span></div>
                        </div>
                    </div>
                    
                    <div class="warning" id="shaft-warning" style="display: none;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span id="warning-text" data-i18n="warning.default">Warning message will appear here if issues are detected</span>
                    </div>
                    
                    <div class="success" id="shaft-success" style="display: none;">
                        <i class="fas fa-check-circle"></i>
                        <span id="success-text" data-i18n="success.default">Shaft design meets all requirements</span>
                    </div>
                    
                    <h3 data-i18n="shaft.material-summary">Material & Service Summary</h3>
                    <div id="material-summary">
                        <!-- Material summary will be added here -->
                        <div class="loading" data-i18n="message.calculate-to-see">Calculate shaft to see material summary</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- System Analysis Tab -->
        <div class="tab-content" id="analysis">
            <div class="two-column">
                <div class="column">
                    <h2 data-i18n="analysis.title">System Performance</h2>
                    
                    <div class="gear-visualization">
                        <canvas id="analysis-canvas" width="500" height="350"></canvas>
                    </div>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.total-efficiency">Total Efficiency</div>
                            <div class="result-value" id="total-efficiency">91.2<span class="result-unit" data-i18n="unit.percent">%</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.total-power-loss">Power Loss</div>
                            <div class="result-value" id="total-power-loss">0.88<span class="result-unit" data-i18n="unit.kw">kW</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.total-heat">Heat Generation</div>
                            <div class="result-value" id="total-heat">880<span class="result-unit" data-i18n="unit.w">W</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.system-weight">System Weight</div>
                            <div class="result-value" id="system-weight">38.5<span class="result-unit" data-i18n="unit.kg">kg</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.system-volume">Volume</div>
                            <div class="result-value" id="system-volume">0.025<span class="result-unit" data-i18n="unit.m3">m³</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.cost-estimate">Cost Estimate</div>
                            <div class="result-value" id="cost-estimate">$425<span class="result-unit"></span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.expected-life">Expected Life</div>
                            <div class="result-value" id="expected-life">>20,000<span class="result-unit" data-i18n="unit.hours">hrs</span></div>
                        </div>
                        <div class="result-box">
                            <div class="result-label" data-i18n="result.reliability">Reliability</div>
                            <div class="result-value" id="reliability">98.5<span class="result-unit" data-i18n="unit.percent">%</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="column">
                    <h2 data-i18n="analysis.results">Analysis Results</h2>
                    
                    <div class="form-group">
                        <label for="analysis-type" data-i18n="analysis.type">Analysis Type</label>
                        <select id="analysis-type">
                            <option value="static" data-i18n="analysis.static">Static Analysis</option>
                            <option value="fatigue" data-i18n="analysis.fatigue">Fatigue Analysis</option>
                            <option value="thermal" data-i18n="analysis.thermal">Thermal Analysis</option>
                            <option value="vibration" data-i18n="analysis.vibration">Vibration Analysis</option>
                        </select>
                    </div>
                    
                    <div id="analysis-results">
                        <h3 data-i18n="analysis.static">Static Analysis</h3>
                        <p data-i18n="analysis.static-description">Static analysis evaluates the system under maximum load conditions.</p>
                        
                        <div class="gear-stage">
                            <div class="stage-header">
                                <div class="stage-title" data-i18n="analysis.gearbox">Gearbox</div>
                                <div class="stage-ratio" data-i18n="status.pass">Status: PASS</div>
                            </div>
                            <p><strong data-i18n="result.max-stress">Max stress:</strong> 85.3 MPa <span data-i18n="analysis.allowable">(Allowable: 210 MPa)</span></p>
                            <p><strong data-i18n="result.deflection">Deflection:</strong> 0.12 mm <span data-i18n="analysis.allowable">(Allowable: 0.25 mm)</span></p>
                            <p><strong data-i18n="result.safety-margin">Safety margin:</strong> 146%</p>
                        </div>
                        
                        <div class="gear-stage">
                            <div class="stage-header">
                                <div class="stage-title" data-i18n="analysis.shafts">Shafts</div>
                                <div class="stage-ratio" data-i18n="status.pass">Status: PASS</div>
                            </div>
                            <p><strong data-i18n="result.max-torsional-stress">Max torsional stress:</strong> 32.5 MPa <span data-i18n="analysis.allowable">(Allowable: 85 MPa)</span></p>
                            <p><strong data-i18n="result.max-bending-stress">Max bending stress:</strong> 45.8 MPa <span data-i18n="analysis.allowable">(Allowable: 120 MPa)</span></p>
                            <p><strong data-i18n="result.critical-speed-margin">Critical speed margin:</strong> 3.5× operating speed</p>
                        </div>
                        
                        <div class="gear-stage">
                            <div class="stage-header">
                                <div class="stage-title" data-i18n="analysis.bearings">Bearings</div>
                                <div class="stage-ratio" data-i18n="status.pass">Status: PASS</div>
                            </div>
                            <p><strong data-i18n="result.bearing-life">Bearing life (L10):</strong> 28,500 hours</p>
                            <p><strong data-i18n="result.dynamic-load-rating">Dynamic load rating:</strong> 15.2 kN <span data-i18n="analysis.required">(Required: 12.8 kN)</span></p>
                            <p><strong data-i18n="result.static-load-rating">Static load rating:</strong> 8.5 kN <span data-i18n="analysis.required">(Required: 7.2 kN)</span></p>
                        </div>
                        
                        <div class="warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong data-i18n="analysis.recommendations">Recommendations:</strong> <span data-i18n="analysis.recommendation-text">Consider adding cooling fins for thermal management. Monitor gear wear after 10,000 hours of operation.</span>
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <button class="calculate-btn" id="run-analysis">
                            <i class="fas fa-chart-line"></i> <span data-i18n="button.run-analysis">Run Complete Analysis</span>
                        </button>
                        <button class="reset-btn" id="export-data">
                            <i class="fas fa-file-export"></i> <span data-i18n="button.export-data">Export Data</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal for adding gear stage -->
        <div class="modal" id="gear-stage-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 data-i18n="modal.gear-stage">Add/Edit Gear Stage</h2>
                    <button class="close-modal">&times;</button>
                </div>
                
                <div class="gear-config">
                    <div class="form-group">
                        <label for="stage-number" data-i18n="modal.stage-number">Stage Number</label>
                        <input type="number" id="stage-number" min="1" max="10" value="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="stage-ratio" data-i18n="modal.stage-ratio">Stage Ratio</label>
                        <div class="input-with-unit">
                            <input type="number" id="stage-ratio" min="1" max="100" step="0.1" value="3.5">
                            <div class="unit" data-i18n="unit.ratio">:1</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="gear1-teeth" data-i18n="modal.gear1-teeth">Gear 1 Teeth</label>
                        <input type="number" id="gear1-teeth" min="10" max="200" value="20">
                    </div>
                    
                    <div class="form-group">
                        <label for="gear2-teeth" data-i18n="modal.gear2-teeth">Gear 2 Teeth</label>
                        <input type="number" id="gear2-teeth" min="10" max="200" value="70">
                    </div>
                    
                    <div class="form-group">
                        <label for="stage-module" data-i18n="modal.stage-module">Module</label>
                        <div class="input-with-unit">
                            <input type="number" id="stage-module" min="0.5" max="20" step="0.5" value="2.5">
                            <div class="unit" data-i18n="unit.mm">mm</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="stage-width" data-i18n="modal.stage-width">Face Width</label>
                        <div class="input-with-unit">
                            <input type="number" id="stage-width" min="5" max="200" value="30">
                            <div class="unit" data-i18n="unit.mm">mm</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="stage-type" data-i18n="modal.stage-type">Gear Type</label>
                        <select id="stage-type">
                            <option value="spur" data-i18n="gear-type.spur">Spur Gear</option>
                            <option value="helical" data-i18n="gear-type.helical">Helical Gear</option>
                            <option value="double-helical" data-i18n="gear-type.double-helical">Double Helical</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="stage-efficiency" data-i18n="modal.stage-efficiency">Stage Efficiency</label>
                        <div class="input-with-unit">
                            <input type="number" id="stage-efficiency" min="85" max="99.9" step="0.1" value="97.5">
                            <div class="unit" data-i18n="unit.percent">%</div>
                        </div>
                    </div>
                </div>
                
                <div class="buttons" style="margin-top: 25px;">
                    <button class="calculate-btn" id="save-gear-stage">
                        <i class="fas fa-save"></i> <span data-i18n="button.save">Save Stage</span>
                    </button>
                    <button class="reset-btn" id="cancel-gear-stage">
                        <span data-i18n="button.cancel">Cancel</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal for load point configuration -->
        <div class="modal" id="load-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 data-i18n="modal.load-points">Configure Load Points</h2>
                    <button class="close-modal">&times;</button>
                </div>
                
                <div id="load-points-config">
                    <!-- Load points will be added here -->
                </div>
                
                <div class="buttons" style="margin-top: 25px;">
                    <button class="calculate-btn" id="save-loads">
                        <i class="fas fa-save"></i> <span data-i18n="button.save">Save Loads</span>
                    </button>
                    <button class="reset-btn" id="cancel-loads">
                        <span data-i18n="button.cancel">Cancel</span>
                    </button>
                </div>
            </div>
        </div>
        
        <footer>
            <p id="footer-text">Multilingual Gearbox & Shaft Design System with Material Specifications and Service Factors</p>
            <p id="footer-note" data-i18n="footer.note">Note: This tool provides engineering estimates. For critical applications, verify with professional analysis software and physical testing.</p>
        </footer>
    </div>

    <script>
        // Global variables
        let currentTab = 'single-gear';
        let gearStages = [];
        let shaftLoads = [];
        let currentGearStageEdit = null;
        let currentLoadEdit = null;
        let currentMaterial = 'steel-mild';
        let customMaterialActive = false;
        let serviceFactors = {
            loadType: 1.25,
            dutyCycle: 1.25,
            reliability: 1.25,
            temperature: 1.0,
            surface: 1.1,
            size: 1.0
        };
        
        // Current language
        let currentLanguage = 'en';
        
        // Material properties database
        const materialDB = {
            'steel-mild': {
                name: { en: 'Mild Steel (AISI 1020)', de: 'Baustahl (AISI 1020)' },
                yieldStrength: 250, // MPa
                ultimateStrength: 400, // MPa
                shearStrength: 145, // MPa
                elasticModulus: 210, // GPa
                density: 7850, // kg/m³
                poissonRatio: 0.3,
                fatigueLimit: 140, // MPa
                thermalConductivity: 51.9, // W/(m·K)
                thermalExpansion: 11.7, // µm/(m·K)
                costFactor: 1.0
            },
            'steel-alloy': {
                name: { en: 'Alloy Steel (AISI 4340)', de: 'Legierter Stahl (AISI 4340)' },
                yieldStrength: 470, // MPa
                ultimateStrength: 745, // MPa
                shearStrength: 285, // MPa
                elasticModulus: 205, // GPa
                density: 7850, // kg/m³
                poissonRatio: 0.29,
                fatigueLimit: 260, // MPa
                thermalConductivity: 44.5, // W/(m·K)
                thermalExpansion: 12.3, // µm/(m·K)
                costFactor: 1.8
            },
            'steel-stainless': {
                name: { en: 'Stainless Steel (AISI 304)', de: 'Edelstahl (AISI 304)' },
                yieldStrength: 215, // MPa
                ultimateStrength: 505, // MPa
                shearStrength: 210, // MPa
                elasticModulus: 193, // GPa
                density: 8000, // kg/m³
                poissonRatio: 0.29,
                fatigueLimit: 240, // MPa
                thermalConductivity: 16.2, // W/(m·K)
                thermalExpansion: 17.2, // µm/(m·K)
                costFactor: 2.5
            },
            'aluminum': {
                name: { en: 'Aluminum Alloy (6061-T6)', de: 'Aluminiumlegierung (6061-T6)' },
                yieldStrength: 275, // MPa
                ultimateStrength: 310, // MPa
                shearStrength: 165, // MPa
                elasticModulus: 69, // GPa
                density: 2700, // kg/m³
                poissonRatio: 0.33,
                fatigueLimit: 97, // MPa
                thermalConductivity: 167, // W/(m·K)
                thermalExpansion: 23.6, // µm/(m·K)
                costFactor: 3.2
            }
        };
        
        // Canvas contexts
        const singleGearCtx = document.getElementById('single-gear-canvas').getContext('2d');
        const gearboxCtx = document.getElementById('gearbox-canvas').getContext('2d');
        const shaftCtx = document.getElementById('shaft-canvas').getContext('2d');
        const analysisCtx = document.getElementById('analysis-canvas').getContext('2d');
        
        // DOM Elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const gearStageModal = document.getElementById('gear-stage-modal');
        const loadModal = document.getElementById('load-modal');
        const closeModalBtns = document.querySelectorAll('.close-modal');
        const cancelGearStageBtn = document.getElementById('cancel-gear-stage');
        const saveGearStageBtn = document.getElementById('save-gear-stage');
        const addGearStageBtn = document.getElementById('add-gear-stage');
        const addLoadPointBtn = document.getElementById('add-load-point');
        const saveLoadsBtn = document.getElementById('save-loads');
        const cancelLoadsBtn = document.getElementById('cancel-loads');
        const gearboxStagesList = document.getElementById('gearbox-stages');
        const stageDetails = document.getElementById('stage-details');
        const materialSummary = document.getElementById('material-summary');
        const shaftWarning = document.getElementById('shaft-warning');
        const shaftSuccess = document.getElementById('shaft-success');
        const warningText = document.getElementById('warning-text');
        const successText = document.getElementById('success-text');
        const customMaterialBtn = document.getElementById('custom-material');
        const customMaterialSection = document.getElementById('custom-material-section');
        const materialOptions = document.querySelectorAll('.material-option');
        const langButtons = document.querySelectorAll('.lang-btn');
        
        // Translation dictionary
        const translations = {
            en: {
                // Header
                "header.title": "Multilingual Gearbox & Shaft Design System",
                "header.description": "Design complete gear systems with material specifications and service factors",
                
                // Tabs
                "tab.single-gear": "Single Gear Design",
                "tab.gearbox": "Gearbox Design",
                "tab.shaft": "Shaft Design",
                "tab.analysis": "System Analysis",
                
                // Single Gear
                "single-gear.title": "Gear Parameters",
                "single-gear.gear-type": "Gear Type",
                "single-gear.module": "Module (m)",
                "single-gear.teeth": "Number of Teeth (z)",
                "single-gear.pressure-angle": "Pressure Angle (α)",
                "single-gear.face-width": "Face Width (b)",
                "single-gear.rpm": "Input Speed",
                "single-gear.power": "Input Power",
                "single-gear.results": "Gear Results",
                
                // Gear Types
                "gear-type.spur": "Spur Gear",
                "gear-type.helical": "Helical Gear",
                "gear-type.bevel": "Bevel Gear",
                "gear-type.worm": "Worm Gear",
                "gear-type.double-helical": "Double Helical",
                
                // Pressure Angles
                "pressure-angle.14_5": "14.5° (Old Standard)",
                "pressure-angle.20": "20° (Most Common)",
                "pressure-angle.25": "25° (High Load)",
                
                // Gearbox
                "gearbox.title": "Gearbox Configuration",
                "gearbox.type": "Gearbox Type",
                "gearbox.stages": "Number of Stages",
                "gearbox.stages-1": "1 Stage",
                "gearbox.stages-2": "2 Stages",
                "gearbox.stages-3": "3 Stages",
                "gearbox.stages-4": "4 Stages",
                "gearbox.service-factors": "Gearbox Service Factors",
                "gearbox.input-rpm": "Input Speed",
                "gearbox.input-power": "Input Power",
                "gearbox.total-ratio": "Total Gear Ratio",
                "gearbox.module": "Module (Common)",
                "gearbox.stage-list": "Gear Stages",
                "gearbox.results": "Gearbox Results",
                "gearbox.stage-details": "Gear Stage Details",
                "gearbox.stage": "Stage",
                "gearbox.ratio": "Ratio",
                "gearbox.gears": "Gear 1 / Gear 2",
                "gearbox.actions": "Actions",
                
                // Gearbox Types
                "gearbox-type.parallel": "Parallel Shaft",
                "gearbox-type.planetary": "Planetary Gearset",
                "gearbox-type.worm": "Worm Gearbox",
                "gearbox-type.bevel": "Bevel Gearbox",
                
                // Shaft
                "shaft.title": "Shaft Design Parameters",
                "shaft.geometry": "Shaft Geometry",
                "shaft.length": "Shaft Length",
                "shaft.diameter": "Base Diameter",
                "shaft.taper": "Taper Ratio",
                "shaft.material": "Material Specification",
                "shaft.service-factors": "Service Factors & Load Conditions",
                "shaft.desired-safety": "Desired Safety Factor",
                "shaft.torque": "Applied Torque",
                "shaft.speed": "Shaft Speed",
                "shaft.bearings": "Number of Bearings",
                "shaft.bearings-2": "2 Bearings",
                "shaft.bearings-3": "3 Bearings",
                "shaft.bearings-4": "4 Bearings",
                "shaft.loads": "Number of Load Points",
                "shaft.loads-1": "1 Load",
                "shaft.loads-2": "2 Loads",
                "shaft.loads-3": "3 Loads",
                "shaft.loads-4": "4 Loads",
                "shaft.results": "Shaft Design Results",
                "shaft.material-summary": "Material & Service Summary",
                "shaft.gearbox-compliance": "Gearbox Shaft Compliance",
                "shaft.gearbox-compliance-desc": "Design the shaft using gearbox output torque, speed, and mounting limits.",
                "shaft.gearbox-tag": "Gearbox Driven",
                "shaft.gearbox-inputs": "Gearbox Inputs",
                "shaft.gearbox-inputs-desc": "Align applied torque and speed with gearbox results.",
                "shaft.gearbox-inputs-item1": "Use service factor-adjusted torque",
                "shaft.gearbox-inputs-item2": "Match output speed for critical speed check",
                "shaft.interface": "Interface Fit",
                "shaft.interface-desc": "Confirm the shaft fits gearbox bore and key interface.",
                "shaft.interface-item1": "Diameter & fit class within gearbox limits",
                "shaft.interface-item2": "Keyway or spline matches coupling",
                "shaft.support": "Support Layout",
                "shaft.support-desc": "Bearings and loads aligned to gearbox housing.",
                "shaft.support-item1": "Bearing span within housing length",
                "shaft.support-item2": "Load points aligned with gear meshes",
                "shaft.gearbox-interface": "Gearbox Interface & Fit",
                "shaft.gearbox-bore": "Gearbox Output Bore",
                "shaft.hub-length": "Coupling Hub Length",
                "shaft.fit-class": "Fit Class",
                "shaft.keyway": "Keyway / Spline",
                "shaft.keyway-parallel": "Parallel Key",
                "shaft.keyway-woodruff": "Woodruff Key",
                "shaft.keyway-spline": "Involute Spline",
                "shaft.alignment": "Alignment Target",
                "shaft.alignment-standard": "Standard (≤ 0.1 mm)",
                "shaft.alignment-precision": "Precision (≤ 0.05 mm)",
                "shaft.alignment-high": "High Precision (≤ 0.02 mm)",
                "shaft.compliance-check": "Gearbox Compliance Check",
                "shaft.compliance-item1": "Torque & service factor aligned with gearbox",
                "shaft.compliance-item2": "Output bore & fit class validated",
                "shaft.compliance-item3": "Bearing span within gearbox housing",
                "shaft.compliance-ok": "OK",
                "shaft.compliance-review": "Review",
                
                // Material
                "material.mild-steel": "Mild Steel",
                "material.alloy-steel": "Alloy Steel",
                "material.stainless-steel": "Stainless Steel",
                "material.aluminum": "Aluminum Alloy",
                "material.custom": "Custom",
                "material.properties": "Material Properties",
                "material.yield-strength": "Yield Strength (σ_y)",
                "material.ultimate-strength": "Ultimate Strength (σ_u)",
                "material.shear-strength": "Shear Strength (τ_max)",
                "material.elastic-modulus": "Modulus of Elasticity (E)",
                "material.density": "Density (ρ)",
                "material.poisson-ratio": "Poisson's Ratio (ν)",
                "material.custom-properties": "Custom Material Properties",
                
                // Service Factors
                "service.application": "Application Service Factors",
                "service.load-type": "Load Type Factor",
                "service.load-uniform": "Uniform (1.0)",
                "service.load-moderate": "Moderate Shock (1.25)",
                "service.load-heavy": "Heavy Shock (1.5)",
                "service.load-severe": "Severe Shock (1.75)",
                "service.duty-cycle": "Duty Cycle Factor",
                "service.duty-continuous": "Continuous (1.0)",
                "service.duty-8h": "8-10 hours/day (1.1)",
                "service.duty-intermittent": "Intermittent (1.25)",
                "service.duty-occasional": "Occasional (1.5)",
                "service.reliability": "Reliability Factor",
                "service.reliability-90": "90% (1.0)",
                "service.reliability-95": "95% (1.1)",
                "service.reliability-99": "99% (1.25)",
                "service.reliability-99_9": "99.9% (1.5)",
                "service.temperature": "Temperature Factor",
                "service.temp-below120": "Below 120°C (1.0)",
                "service.temp-120-200": "120-200°C (1.1)",
                "service.temp-200-300": "200-300°C (1.25)",
                "service.temp-above300": "Above 300°C (1.5)",
                "service.surface-finish": "Surface Finish Factor",
                "service.surface-ground": "Ground (1.0)",
                "service.surface-machined": "Machined (1.1)",
                "service.surface-hot-rolled": "Hot Rolled (1.25)",
                "service.surface-forged": "Forged (1.5)",
                "service.size": "Size Factor",
                "service.size-50": "d ≤ 50mm (1.0)",
                "service.size-100": "50-100mm (1.1)",
                "service.size-200": "100-200mm (1.25)",
                "service.size-above200": ">200mm (1.5)",
                "service.total-factor": "Total Service Factor (K)",
                
                // Results
                "result.pitch-diameter": "Pitch Diameter",
                "result.outer-diameter": "Outer Diameter",
                "result.tangential-force": "Tangential Force",
                "result.torque": "Torque",
                "result.circular-pitch": "Circular Pitch",
                "result.contact-ratio": "Contact Ratio",
                "result.bending-stress": "Bending Stress",
                "result.safety-factor": "Safety Factor",
                "result.output-rpm": "Output Speed",
                "result.output-torque": "Output Torque",
                "result.gearbox-efficiency": "Total Efficiency",
                "result.power-loss": "Power Loss",
                "result.center-distance": "Center Distance",
                "result.overall-size": "Overall Size",
                "result.gearbox-weight": "Weight (Approx.)",
                "result.heat-generated": "Heat Generated",
                "result.torsional-stress": "Torsional Stress",
                "result.bending-stress": "Bending Stress",
                "result.von-mises-stress": "Von Mises Stress",
                "result.max-deflection": "Max Deflection",
                "result.critical-speed": "Critical Speed",
                "result.torsional-stiffness": "Torsional Stiffness",
                "result.sf-static": "Safety Factor (Static)",
                "result.sf-fatigue": "Safety Factor (Fatigue)",
                "result.applied-service-factor": "Service Factor Applied",
                "result.overall-rating": "Overall Rating",
                "result.total-efficiency": "Total Efficiency",
                "result.total-power-loss": "Power Loss",
                "result.total-heat": "Heat Generation",
                "result.system-weight": "System Weight",
                "result.system-volume": "Volume",
                "result.cost-estimate": "Cost Estimate",
                "result.expected-life": "Expected Life",
                "result.reliability": "Reliability",
                "result.max-stress": "Max stress",
                "result.deflection": "Deflection",
                "result.safety-margin": "Safety margin",
                "result.max-torsional-stress": "Max torsional stress",
                "result.max-bending-stress": "Max bending stress",
                "result.critical-speed-margin": "Critical speed margin",
                "result.bearing-life": "Bearing life (L10)",
                "result.dynamic-load-rating": "Dynamic load rating",
                "result.static-load-rating": "Static load rating",
                
                // Units
                "unit.mm": "mm",
                "unit.rpm": "RPM",
                "unit.kw": "kW",
                "unit.n": "N",
                "unit.nm": "Nm",
                "unit.mpa": "MPa",
                "unit.percent": "%",
                "unit.ratio": ":1",
                "unit.kg": "kg",
                "unit.w": "W",
                "unit.gpa": "GPa",
                "unit.kg-m3": "kg/m³",
                "unit.nm-rad": "Nm/rad",
                "unit.m3": "m³",
                "unit.hours": "hrs",
                
                // Status
                "status.safe": "Safe",
                "status.pass": "Status: PASS",
                
                // Analysis
                "analysis.title": "System Performance",
                "analysis.results": "Analysis Results",
                "analysis.type": "Analysis Type",
                "analysis.static": "Static Analysis",
                "analysis.fatigue": "Fatigue Analysis",
                "analysis.thermal": "Thermal Analysis",
                "analysis.vibration": "Vibration Analysis",
                "analysis.static-description": "Static analysis evaluates the system under maximum load conditions.",
                "analysis.gearbox": "Gearbox",
                "analysis.shafts": "Shafts",
                "analysis.bearings": "Bearings",
                "analysis.allowable": "(Allowable",
                "analysis.required": "(Required",
                "analysis.recommendations": "Recommendations",
                "analysis.recommendation-text": "Consider adding cooling fins for thermal management. Monitor gear wear after 10,000 hours of operation.",
                
                // Buttons
                "button.calculate": "Calculate Gear",
                "button.reset": "Reset",
                "button.add-stage": "Add Gear Stage",
                "button.calculate-gearbox": "Calculate Gearbox",
                "button.reset-gearbox": "Reset Gearbox",
                "button.configure-loads": "Configure Load Points",
                "button.calculate-shaft": "Calculate Shaft",
                "button.run-analysis": "Run Complete Analysis",
                "button.export-data": "Export Data",
                "button.export-stp": "Export Gear (.stp)",
                "button.save": "Save",
                "button.cancel": "Cancel",
                "button.save-stage": "Save Stage",
                
                // Modals
                "modal.gear-stage": "Add/Edit Gear Stage",
                "modal.stage-number": "Stage Number",
                "modal.stage-ratio": "Stage Ratio",
                "modal.gear1-teeth": "Gear 1 Teeth",
                "modal.gear2-teeth": "Gear 2 Teeth",
                "modal.stage-module": "Module",
                "modal.stage-width": "Face Width",
                "modal.stage-type": "Gear Type",
                "modal.stage-efficiency": "Stage Efficiency",
                "modal.load-points": "Configure Load Points",
                
                // Messages
                "message.calculate-to-see": "Calculate to see details",
                "message.export-stp-success": "STEP file downloaded with the current gear parameters.",
                "warning.default": "Warning message will appear here if issues are detected",
                "success.default": "Shaft design meets all requirements",
                
                // Footer
                "footer.note": "Note: This tool provides engineering estimates. For critical applications, verify with professional analysis software and physical testing."
            },
            de: {
                // Header
                "header.title": "Mehrsprachiges Getriebe- und Wellen-Designsystem",
                "header.description": "Entwerfen Sie komplette Getriebesysteme mit Materialspezifikationen und Betriebsfaktoren",
                
                // Tabs
                "tab.single-gear": "Einzelne Zahnradauslegung",
                "tab.gearbox": "Getriebeauslegung",
                "tab.shaft": "Wellenauslegung",
                "tab.analysis": "Systemanalyse",
                
                // Single Gear
                "single-gear.title": "Zahnradparameter",
                "single-gear.gear-type": "Zahnradtyp",
                "single-gear.module": "Modul (m)",
                "single-gear.teeth": "Zähnezahl (z)",
                "single-gear.pressure-angle": "Eingriffswinkel (α)",
                "single-gear.face-width": "Zahnbreite (b)",
                "single-gear.rpm": "Eingangsdrehzahl",
                "single-gear.power": "Eingangsleistung",
                "single-gear.results": "Zahnradergebnisse",
                
                // Gear Types
                "gear-type.spur": "Stirnrad",
                "gear-type.helical": "Schrägstirnrad",
                "gear-type.bevel": "Kegelrad",
                "gear-type.worm": "Schneckenrad",
                "gear-type.double-helical": "Doppelschrägstirnrad",
                
                // Pressure Angles
                "pressure-angle.14_5": "14,5° (Alter Standard)",
                "pressure-angle.20": "20° (Am häufigsten)",
                "pressure-angle.25": "25° (Hohe Belastung)",
                
                // Gearbox
                "gearbox.title": "Getriebekonfiguration",
                "gearbox.type": "Getriebetyp",
                "gearbox.stages": "Anzahl der Stufen",
                "gearbox.stages-1": "1 Stufe",
                "gearbox.stages-2": "2 Stufen",
                "gearbox.stages-3": "3 Stufen",
                "gearbox.stages-4": "4 Stufen",
                "gearbox.service-factors": "Getriebe-Betriebsfaktoren",
                "gearbox.input-rpm": "Eingangsdrehzahl",
                "gearbox.input-power": "Eingangsleistung",
                "gearbox.total-ratio": "Gesamtübersetzung",
                "gearbox.module": "Modul (Gemeinsam)",
                "gearbox.stage-list": "Getriebestufen",
                "gearbox.results": "Getriebeergebnisse",
                "gearbox.stage-details": "Getriebestufendetails",
                "gearbox.stage": "Stufe",
                "gearbox.ratio": "Übersetzung",
                "gearbox.gears": "Rad 1 / Rad 2",
                "gearbox.actions": "Aktionen",
                
                // Gearbox Types
                "gearbox-type.parallel": "Parallelwelle",
                "gearbox-type.planetary": "Planetengetriebe",
                "gearbox-type.worm": "Schneckengetriebe",
                "gearbox-type.bevel": "Kegelradgetriebe",
                
                // Shaft
                "shaft.title": "Wellenauslegungsparameter",
                "shaft.geometry": "Wellengeometrie",
                "shaft.length": "Wellenlänge",
                "shaft.diameter": "Basisdurchmesser",
                "shaft.taper": "Verjüngungsverhältnis",
                "shaft.material": "Materialspezifikation",
                "shaft.service-factors": "Betriebsfaktoren & Lastbedingungen",
                "shaft.desired-safety": "Gewünschter Sicherheitsfaktor",
                "shaft.torque": "Angewendetes Drehmoment",
                "shaft.speed": "Wellendrehzahl",
                "shaft.bearings": "Anzahl der Lager",
                "shaft.bearings-2": "2 Lager",
                "shaft.bearings-3": "3 Lager",
                "shaft.bearings-4": "4 Lager",
                "shaft.loads": "Anzahl der Lastpunkte",
                "shaft.loads-1": "1 Last",
                "shaft.loads-2": "2 Lasten",
                "shaft.loads-3": "3 Lasten",
                "shaft.loads-4": "4 Lasten",
                "shaft.results": "Wellenauslegungsergebnisse",
                "shaft.material-summary": "Material- & Betriebszusammenfassung",
                "shaft.gearbox-compliance": "Getriebe-Wellen-Kompatibilität",
                "shaft.gearbox-compliance-desc": "Die Welle mit Getriebeausgangsdrehmoment, Drehzahl und Einbauraum auslegen.",
                "shaft.gearbox-tag": "Getriebegetrieben",
                "shaft.gearbox-inputs": "Getriebe-Eingaben",
                "shaft.gearbox-inputs-desc": "Drehmoment und Drehzahl mit Getriebeergebnissen abstimmen.",
                "shaft.gearbox-inputs-item1": "Mit Betriebsfaktor angepasstes Drehmoment verwenden",
                "shaft.gearbox-inputs-item2": "Ausgangsdrehzahl für kritische Drehzahlprüfung übernehmen",
                "shaft.interface": "Passung & Schnittstelle",
                "shaft.interface-desc": "Sicherstellen, dass die Welle zur Getriebebohrung und Passfeder passt.",
                "shaft.interface-item1": "Durchmesser & Passung innerhalb der Getriebegrenzen",
                "shaft.interface-item2": "Passfeder oder Verzahnung passend zur Kupplung",
                "shaft.support": "Lagerung & Layout",
                "shaft.support-desc": "Lager und Lasten mit dem Getriebegehäuse ausrichten.",
                "shaft.support-item1": "Lagerspannweite innerhalb der Gehäuselänge",
                "shaft.support-item2": "Lastpunkte an Zahneingriffen ausrichten",
                "shaft.gearbox-interface": "Getriebe-Schnittstelle & Passung",
                "shaft.gearbox-bore": "Getriebeausgangsbohrung",
                "shaft.hub-length": "Kupplungsnabenlänge",
                "shaft.fit-class": "Passungsklasse",
                "shaft.keyway": "Passfeder / Verzahnung",
                "shaft.keyway-parallel": "Parallelkeil",
                "shaft.keyway-woodruff": "Scheibenfeder",
                "shaft.keyway-spline": "Evolventenverzahnung",
                "shaft.alignment": "Ausrichtungsziel",
                "shaft.alignment-standard": "Standard (≤ 0,1 mm)",
                "shaft.alignment-precision": "Präzision (≤ 0,05 mm)",
                "shaft.alignment-high": "Hochpräzise (≤ 0,02 mm)",
                "shaft.compliance-check": "Getriebe-Kompatibilitätsprüfung",
                "shaft.compliance-item1": "Drehmoment & Betriebsfaktor mit Getriebe abgestimmt",
                "shaft.compliance-item2": "Ausgangsbohrung & Passung geprüft",
                "shaft.compliance-item3": "Lagerspannweite innerhalb des Gehäuses",
                "shaft.compliance-ok": "OK",
                "shaft.compliance-review": "Prüfen",
                
                // Material
                "material.mild-steel": "Baustahl",
                "material.alloy-steel": "Legierter Stahl",
                "material.stainless-steel": "Edelstahl",
                "material.aluminum": "Aluminiumlegierung",
                "material.custom": "Benutzerdefiniert",
                "material.properties": "Materialeigenschaften",
                "material.yield-strength": "Streckgrenze (σ_y)",
                "material.ultimate-strength": "Zugfestigkeit (σ_u)",
                "material.shear-strength": "Scherfestigkeit (τ_max)",
                "material.elastic-modulus": "Elastizitätsmodul (E)",
                "material.density": "Dichte (ρ)",
                "material.poisson-ratio": "Poisson-Zahl (ν)",
                "material.custom-properties": "Benutzerdefinierte Materialeigenschaften",
                
                // Service Factors
                "service.application": "Anwendungsbetriebsfaktoren",
                "service.load-type": "Lasttypfaktor",
                "service.load-uniform": "Gleichmäßig (1,0)",
                "service.load-moderate": "Mäßiger Stoß (1,25)",
                "service.load-heavy": "Starker Stoß (1,5)",
                "service.load-severe": "Extremer Stoß (1,75)",
                "service.duty-cycle": "Einsatzdauerfaktor",
                "service.duty-continuous": "Dauerbetrieb (1,0)",
                "service.duty-8h": "8-10 Stunden/Tag (1,1)",
                "service.duty-intermittent": "Intermittierend (1,25)",
                "service.duty-occasional": "Gelegentlich (1,5)",
                "service.reliability": "Zuverlässigkeitsfaktor",
                "service.reliability-90": "90% (1,0)",
                "service.reliability-95": "95% (1,1)",
                "service.reliability-99": "99% (1,25)",
                "service.reliability-99_9": "99,9% (1,5)",
                "service.temperature": "Temperaturfaktor",
                "service.temp-below120": "Unter 120°C (1,0)",
                "service.temp-120-200": "120-200°C (1,1)",
                "service.temp-200-300": "200-300°C (1,25)",
                "service.temp-above300": "Über 300°C (1,5)",
                "service.surface-finish": "Oberflächengütefaktor",
                "service.surface-ground": "Geschliffen (1,0)",
                "service.surface-machined": "Gedreht/gefäst (1,1)",
                "service.surface-hot-rolled": "Warmgewalzt (1,25)",
                "service.surface-forged": "Geschmiedet (1,5)",
                "service.size": "Größenfaktor",
                "service.size-50": "d ≤ 50mm (1,0)",
                "service.size-100": "50-100mm (1,1)",
                "service.size-200": "100-200mm (1,25)",
                "service.size-above200": ">200mm (1,5)",
                "service.total-factor": "Gesamtbetriebsfaktor (K)",
                
                // Results
                "result.pitch-diameter": "Teilkreisdurchmesser",
                "result.outer-diameter": "Außendurchmesser",
                "result.tangential-force": "Umfangskraft",
                "result.torque": "Drehmoment",
                "result.circular-pitch": "Teilung",
                "result.contact-ratio": "Überdeckungsgrad",
                "result.bending-stress": "Biegespannung",
                "result.safety-factor": "Sicherheitsfaktor",
                "result.output-rpm": "Ausgangsdrehzahl",
                "result.output-torque": "Ausgangsdrehmoment",
                "result.gearbox-efficiency": "Gesamtwirkungsgrad",
                "result.power-loss": "Leistungsverlust",
                "result.center-distance": "Achsmittenabstand",
                "result.overall-size": "Gesamtgröße",
                "result.gearbox-weight": "Gewicht (ca.)",
                "result.heat-generated": "Wärmeerzeugung",
                "result.torsional-stress": "Torsionsspannung",
                "result.bending-stress": "Biegespannung",
                "result.von-mises-stress": "Vergleichsspannung (von Mises)",
                "result.max-deflection": "Max. Durchbiegung",
                "result.critical-speed": "Kritische Drehzahl",
                "result.torsional-stiffness": "Torsionssteifigkeit",
                "result.sf-static": "Sicherheitsfaktor (statisch)",
                "result.sf-fatigue": "Sicherheitsfaktor (Dauerfestigkeit)",
                "result.applied-service-factor": "Angewendeter Betriebsfaktor",
                "result.overall-rating": "Gesamtbewertung",
                "result.total-efficiency": "Gesamtwirkungsgrad",
                "result.total-power-loss": "Leistungsverlust",
                "result.total-heat": "Wärmeerzeugung",
                "result.system-weight": "Systemgewicht",
                "result.system-volume": "Volumen",
                "result.cost-estimate": "Kostenschätzung",
                "result.expected-life": "Erwartete Lebensdauer",
                "result.reliability": "Zuverlässigkeit",
                "result.max-stress": "Max. Spannung",
                "result.deflection": "Durchbiegung",
                "result.safety-margin": "Sicherheitsreserve",
                "result.max-torsional-stress": "Max. Torsionsspannung",
                "result.max-bending-stress": "Max. Biegespannung",
                "result.critical-speed-margin": "Kritische Drehzahlreserve",
                "result.bearing-life": "Lagergrundlebensdauer (L10)",
                "result.dynamic-load-rating": "Dynamische Tragzahl",
                "result.static-load-rating": "Statische Tragzahl",
                
                // Units
                "unit.mm": "mm",
                "unit.rpm": "U/min",
                "unit.kw": "kW",
                "unit.n": "N",
                "unit.nm": "Nm",
                "unit.mpa": "MPa",
                "unit.percent": "%",
                "unit.ratio": ":1",
                "unit.kg": "kg",
                "unit.w": "W",
                "unit.gpa": "GPa",
                "unit.kg-m3": "kg/m³",
                "unit.nm-rad": "Nm/rad",
                "unit.m3": "m³",
                "unit.hours": "h",
                
                // Status
                "status.safe": "Sicher",
                "status.pass": "Status: BESTANDEN",
                
                // Analysis
                "analysis.title": "Systemleistung",
                "analysis.results": "Analyseergebnisse",
                "analysis.type": "Analysetyp",
                "analysis.static": "Statische Analyse",
                "analysis.fatigue": "Dauerfestigkeitsanalyse",
                "analysis.thermal": "Thermische Analyse",
                "analysis.vibration": "Schwingungsanalyse",
                "analysis.static-description": "Die statische Analyse bewertet das System unter maximalen Lastbedingungen.",
                "analysis.gearbox": "Getriebe",
                "analysis.shafts": "Wellen",
                "analysis.bearings": "Lager",
                "analysis.allowable": "(Zulässig",
                "analysis.required": "(Erforderlich",
                "analysis.recommendations": "Empfehlungen",
                "analysis.recommendation-text": "Ziehen Sie Kühlrippen für das Wärmemanagement in Betracht. Überwachen Sie den Zahnradverschleiß nach 10.000 Betriebsstunden.",
                
                // Buttons
                "button.calculate": "Zahnrad berechnen",
                "button.reset": "Zurücksetzen",
                "button.add-stage": "Getriebestufe hinzufügen",
                "button.calculate-gearbox": "Getriebe berechnen",
                "button.reset-gearbox": "Getriebe zurücksetzen",
                "button.configure-loads": "Lastpunkte konfigurieren",
                "button.calculate-shaft": "Welle berechnen",
                "button.run-analysis": "Komplette Analyse durchführen",
                "button.export-data": "Daten exportieren",
                "button.export-stp": "Zahnrad als .stp exportieren",
                "button.save": "Speichern",
                "button.cancel": "Abbrechen",
                "button.save-stage": "Stufe speichern",
                
                // Modals
                "modal.gear-stage": "Getriebestufe hinzufügen/bearbeiten",
                "modal.stage-number": "Stufennummer",
                "modal.stage-ratio": "Stufenübersetzung",
                "modal.gear1-teeth": "Zähnezahl Rad 1",
                "modal.gear2-teeth": "Zähnezahl Rad 2",
                "modal.stage-module": "Modul",
                "modal.stage-width": "Zahnbreite",
                "modal.stage-type": "Zahnradtyp",
                "modal.stage-efficiency": "Stufenwirkungsgrad",
                "modal.load-points": "Lastpunkte konfigurieren",
                
                // Messages
                "message.calculate-to-see": "Berechnen Sie, um Details zu sehen",
                "message.export-stp-success": "STEP-Datei mit den aktuellen Zahnradparametern heruntergeladen.",
                "warning.default": "Warnmeldung erscheint hier, wenn Probleme erkannt werden",
                "success.default": "Wellenauslegung erfüllt alle Anforderungen",
                
                // Footer
                "footer.note": "Hinweis: Dieses Tool bietet technische Schätzungen. Für kritische Anwendungen überprüfen Sie mit professioneller Analysesoftware und physikalischen Tests."
            }
        };
        
        // Language switching
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update active language button
            langButtons.forEach(btn => {
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Update all translatable elements
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'SELECT') {
                        // Handle placeholders for inputs
                        if (element.getAttribute('placeholder')) {
                            element.setAttribute('placeholder', translations[lang][key]);
                        }
                        // Handle options in select elements
                        if (element.tagName === 'SELECT') {
                            Array.from(element.options).forEach(option => {
                                const optionKey = option.getAttribute('data-i18n');
                                if (optionKey && translations[lang][optionKey]) {
                                    option.textContent = translations[lang][optionKey];
                                }
                            });
                        }
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });
            
            // Update header title and description
            document.getElementById('header-title').textContent = translations[lang]["header.title"];
            document.getElementById('header-description').textContent = translations[lang]["header.description"];
            
            // Update footer
            document.getElementById('footer-text').textContent = translations[lang]["header.description"];
            
            // Update material names
            updateMaterialProperties();
            
            // Recalculate to update dynamic content
            if (currentTab === 'single-gear') {
                calculateSingleGear();
            } else if (currentTab === 'gearbox') {
                calculateGearbox();
            } else if (currentTab === 'shaft') {
                calculateShaft();
            }
        }
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Update active tab
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update active content
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabId) {
                        content.classList.add('active');
                    }
                });
                
                currentTab = tabId;
                
                // Redraw appropriate visualization
                if (tabId === 'single-gear') {
                    calculateSingleGear();
                } else if (tabId === 'gearbox') {
                    drawGearbox();
                } else if (tabId === 'shaft') {
                    calculateServiceFactor();
                    drawShaft();
                } else if (tabId === 'analysis') {
                    drawAnalysis();
                }
            });
        });
        
        // Language selector event listeners
        langButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                const lang = this.getAttribute('data-lang');
                switchLanguage(lang);
            });
        });
        
        // Toggle sections
        document.querySelectorAll('.toggle-section').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const contentId = this.id.replace('-toggle', '-content');
                const content = document.getElementById(contentId);
                
                this.classList.toggle('collapsed');
                content.classList.toggle('collapsed');
            });
        });
        
        // Material selection
        materialOptions.forEach(option => {
            option.addEventListener('click', function() {
                if (this.id === 'custom-material') {
                    // Handle custom material
                    materialOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    customMaterialSection.style.display = 'block';
                    customMaterialActive = true;
                    updateCustomMaterialProperties();
                } else {
                    // Handle predefined materials
                    materialOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    customMaterialSection.style.display = 'none';
                    customMaterialActive = false;
                    
                    currentMaterial = this.getAttribute('data-material');
                    updateMaterialProperties();
                }
            });
        });
        
        // Update material properties display
        function updateMaterialProperties() {
            const material = materialDB[currentMaterial];
            
            // Get material name in current language
            const materialName = material.name[currentLanguage] || material.name.en;
            
            document.getElementById('yield-strength').textContent = `${material.yieldStrength} MPa`;
            document.getElementById('ultimate-strength').textContent = `${material.ultimateStrength} MPa`;
            document.getElementById('shear-strength').textContent = `${material.shearStrength} MPa`;
            document.getElementById('elastic-modulus').textContent = `${material.elasticModulus} GPa`;
            document.getElementById('material-density').textContent = `${material.density} kg/m³`;
            document.getElementById('poisson-ratio').textContent = material.poissonRatio;
            
            // Update material option text if needed
            const materialOption = document.querySelector(`.material-option[data-material="${currentMaterial}"] div`);
            if (materialOption) {
                materialOption.textContent = translations[currentLanguage][`material.${currentMaterial.replace('-', '-')}`];
            }
        }
        
        // Update custom material properties
        function updateCustomMaterialProperties() {
            const yieldStrength = parseFloat(document.getElementById('custom-yield').value) || 250;
            const ultimateStrength = parseFloat(document.getElementById('custom-ultimate').value) || 400;
            const shearStrength = parseFloat(document.getElementById('custom-shear').value) || 145;
            const elasticModulus = parseFloat(document.getElementById('custom-modulus').value) || 210;
            const density = parseFloat(document.getElementById('custom-density').value) || 7850;
            const poissonRatio = parseFloat(document.getElementById('custom-poisson').value) || 0.3;
            
            document.getElementById('yield-strength').textContent = `${yieldStrength} MPa`;
            document.getElementById('ultimate-strength').textContent = `${ultimateStrength} MPa`;
            document.getElementById('shear-strength').textContent = `${shearStrength} MPa`;
            document.getElementById('elastic-modulus').textContent = `${elasticModulus} GPa`;
            document.getElementById('material-density').textContent = `${density} kg/m³`;
            document.getElementById('poisson-ratio').textContent = poissonRatio;
        }
        
        // Calculate service factor for shaft
        function calculateServiceFactor() {
            serviceFactors = {
                loadType: parseFloat(document.getElementById('load-type-factor').value),
                dutyCycle: parseFloat(document.getElementById('duty-cycle-factor').value),
                reliability: parseFloat(document.getElementById('reliability-factor').value),
                temperature: parseFloat(document.getElementById('temperature-factor').value),
                surface: parseFloat(document.getElementById('surface-factor').value),
                size: parseFloat(document.getElementById('size-factor').value)
            };
            
            // Calculate total service factor (product of all factors)
            let totalServiceFactor = 1.0;
            for (const factor in serviceFactors) {
                totalServiceFactor *= serviceFactors[factor];
            }
            
            document.getElementById('total-service-factor').textContent = totalServiceFactor.toFixed(2);
            return totalServiceFactor;
        }
        
        // Calculate gearbox service factor
        function calculateGearboxServiceFactor() {
            const gearboxServiceFactors = {
                loadType: parseFloat(document.getElementById('gearbox-load-type').value),
                dutyCycle: parseFloat(document.getElementById('gearbox-duty-cycle').value),
                reliability: parseFloat(document.getElementById('gearbox-reliability').value),
                temperature: parseFloat(document.getElementById('gearbox-temperature').value)
            };
            
            // Calculate total service factor for gearbox
            let totalGearboxServiceFactor = 1.0;
            for (const factor in gearboxServiceFactors) {
                totalGearboxServiceFactor *= gearboxServiceFactors[factor];
            }
            
            document.getElementById('gearbox-total-factor').textContent = totalGearboxServiceFactor.toFixed(2);
            return totalGearboxServiceFactor;
        }
        
        // Get current material properties
        function getCurrentMaterialProperties() {
            if (customMaterialActive) {
                return {
                    yieldStrength: parseFloat(document.getElementById('custom-yield').value) || 250,
                    ultimateStrength: parseFloat(document.getElementById('custom-ultimate').value) || 400,
                    shearStrength: parseFloat(document.getElementById('custom-shear').value) || 145,
                    elasticModulus: parseFloat(document.getElementById('custom-modulus').value) || 210,
                    density: parseFloat(document.getElementById('custom-density').value) || 7850,
                    poissonRatio: parseFloat(document.getElementById('custom-poisson').value) || 0.3,
                    fatigueLimit: 0.5 * (parseFloat(document.getElementById('custom-yield').value) || 250), // Estimate
                    name: { en: 'Custom Material', de: 'Benutzerdefiniertes Material' }
                };
            } else {
                return materialDB[currentMaterial];
            }
        }
        
        // Modal handling
        function openGearStageModal(stage = null) {
            currentGearStageEdit = stage;
            
            if (stage) {
                // Edit existing stage
                document.getElementById('stage-number').value = stage.number;
                document.getElementById('stage-ratio').value = stage.ratio;
                document.getElementById('gear1-teeth').value = stage.gear1Teeth;
                document.getElementById('gear2-teeth').value = stage.gear2Teeth;
                document.getElementById('stage-module').value = stage.module;
                document.getElementById('stage-width').value = stage.width;
                document.getElementById('stage-type').value = stage.type;
                document.getElementById('stage-efficiency').value = stage.efficiency;
            } else {
                // Add new stage
                document.getElementById('stage-number').value = gearStages.length + 1;
                document.getElementById('stage-ratio').value = 3.5;
                document.getElementById('gear1-teeth').value = 20;
                document.getElementById('gear2-teeth').value = 70;
                document.getElementById('stage-module').value = document.getElementById('module-gearbox').value;
                document.getElementById('stage-width').value = 30;
                document.getElementById('stage-type').value = 'spur';
                document.getElementById('stage-efficiency').value = 97.5;
            }
            
            gearStageModal.style.display = 'flex';
        }
        
        function openLoadModal() {
            const numLoads = parseInt(document.getElementById('num-loads').value);
            const loadPointsConfig = document.getElementById('load-points-config');
            loadPointsConfig.innerHTML = '';
            
            // Create load point configuration inputs
            for (let i = 1; i <= numLoads; i++) {
                const loadDiv = document.createElement('div');
                loadDiv.className = 'shaft-section';
                loadDiv.innerHTML = `
                    <h4>${translations[currentLanguage]["modal.load-points"]} ${i}</h4>
                    <div class="shaft-config">
                        <div class="form-group">
                            <label for="load-position-${i}" data-i18n="shaft.position">Position from Left</label>
                            <div class="input-with-unit">
                                <input type="number" id="load-position-${i}" min="0" max="1000" value="${100 + i * 100}">
                                <div class="unit" data-i18n="unit.mm">mm</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="load-radial-${i}" data-i18n="shaft.radial-load">Radial Load</label>
                            <div class="input-with-unit">
                                <input type="number" id="load-radial-${i}" min="0" max="100000" value="${500 + i * 200}">
                                <div class="unit" data-i18n="unit.n">N</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="load-axial-${i}" data-i18n="shaft.axial-load">Axial Load</label>
                            <div class="input-with-unit">
                                <input type="number" id="load-axial-${i}" min="0" max="100000" value="${100 + i * 50}">
                                <div class="unit" data-i18n="unit.n">N</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="load-type-${i}" data-i18n="shaft.load-type">Load Type</label>
                            <select id="load-type-${i}">
                                <option value="gear" data-i18n="shaft.load-gear">Gear Load</option>
                                <option value="pulley" data-i18n="shaft.load-pulley">Pulley Load</option>
                                <option value="bearing" data-i18n="shaft.load-bearing">Bearing Reaction</option>
                                <option value="coupling" data-i18n="shaft.load-coupling">Coupling Load</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="load-direction-${i}" data-i18n="shaft.direction">Direction</label>
                            <select id="load-direction-${i}">
                                <option value="vertical" data-i18n="shaft.direction-vertical">Vertical</option>
                                <option value="horizontal" data-i18n="shaft.direction-horizontal">Horizontal</option>
                                <option value="angled" data-i18n="shaft.direction-angled">Angled (45°)</option>
                            </select>
                        </div>
                    </div>
                `;
                loadPointsConfig.appendChild(loadDiv);
            }
            
            // Apply translations to the new elements
            switchLanguage(currentLanguage);
            
            loadModal.style.display = 'flex';
        }
        
        function closeModal(modal) {
            modal.style.display = 'none';
            currentGearStageEdit = null;
        }
        
        closeModalBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const modal = this.closest('.modal');
                closeModal(modal);
            });
        });
        
        cancelGearStageBtn.addEventListener('click', () => closeModal(gearStageModal));
        cancelLoadsBtn.addEventListener('click', () => closeModal(loadModal));
        
        // Save gear stage
        saveGearStageBtn.addEventListener('click', function() {
            const stage = {
                number: parseInt(document.getElementById('stage-number').value),
                ratio: parseFloat(document.getElementById('stage-ratio').value),
                gear1Teeth: parseInt(document.getElementById('gear1-teeth').value),
                gear2Teeth: parseInt(document.getElementById('gear2-teeth').value),
                module: parseFloat(document.getElementById('stage-module').value),
                width: parseFloat(document.getElementById('stage-width').value),
                type: document.getElementById('stage-type').value,
                efficiency: parseFloat(document.getElementById('stage-efficiency').value)
            };
            
            // Calculate actual ratio from teeth
            stage.actualRatio = stage.gear2Teeth / stage.gear1Teeth;
            
            if (currentGearStageEdit) {
                // Update existing stage
                const index = gearStages.findIndex(s => s.number === currentGearStageEdit.number);
                if (index !== -1) {
                    gearStages[index] = stage;
                }
            } else {
                // Add new stage
                gearStages.push(stage);
            }
            
            updateGearStagesList();
            closeModal(gearStageModal);
        });
        
        // Save loads
        saveLoadsBtn.addEventListener('click', function() {
            const numLoads = parseInt(document.getElementById('num-loads').value);
            shaftLoads = [];
            
            for (let i = 1; i <= numLoads; i++) {
                shaftLoads.push({
                    position: parseFloat(document.getElementById(`load-position-${i}`).value),
                    radialLoad: parseFloat(document.getElementById(`load-radial-${i}`).value),
                    axialLoad: parseFloat(document.getElementById(`load-axial-${i}`).value),
                    type: document.getElementById(`load-type-${i}`).value,
                    direction: document.getElementById(`load-direction-${i}`).value
                });
            }
            
            closeModal(loadModal);
            calculateShaft();
        });
        
        // Update gear stages list in UI
        function updateGearStagesList() {
            // Clear existing list (except header)
            while (gearboxStagesList.children.length > 1) {
                gearboxStagesList.removeChild(gearboxStagesList.lastChild);
            }
            
            // Sort stages by number
            gearStages.sort((a, b) => a.number - b.number);
            
            // Add each stage to list
            gearStages.forEach(stage => {
                const stageItem = document.createElement('div');
                stageItem.className = 'gear-item';
                stageItem.innerHTML = `
                    <div class="gear-info">${translations[currentLanguage]["gearbox.stage"]} ${stage.number}</div>
                    <div class="gear-info">${stage.actualRatio.toFixed(2)}:1</div>
                    <div class="gear-info">${stage.gear1Teeth} / ${stage.gear2Teeth} ${currentLanguage === 'en' ? 'teeth' : 'Zähne'}</div>
                    <div class="gear-actions">
                        <button class="action-btn edit-btn" data-stage="${stage.number}">${currentLanguage === 'en' ? 'Edit' : 'Bearbeiten'}</button>
                        <button class="action-btn delete-btn" data-stage="${stage.number}">${currentLanguage === 'en' ? 'Delete' : 'Löschen'}</button>
                    </div>
                `;
                
                gearboxStagesList.appendChild(stageItem);
            });
            
            // Add event listeners for edit/delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const stageNum = parseInt(this.getAttribute('data-stage'));
                    const stage = gearStages.find(s => s.number === stageNum);
                    if (stage) {
                        openGearStageModal(stage);
                    }
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const stageNum = parseInt(this.getAttribute('data-stage'));
                    gearStages = gearStages.filter(s => s.number !== stageNum);
                    updateGearStagesList();
                });
            });
        }
        
        // Add gear stage button
        addGearStageBtn.addEventListener('click', function() {
            openGearStageModal();
        });
        
        // Add load point button
        addLoadPointBtn.addEventListener('click', openLoadModal);
        
        // Initialize with some sample gear stages
        function initializeSampleGearStages() {
            gearStages = [
                {
                    number: 1,
                    ratio: 3.5,
                    gear1Teeth: 20,
                    gear2Teeth: 70,
                    module: 2.5,
                    width: 30,
                    type: 'spur',
                    efficiency: 97.5,
                    actualRatio: 3.5
                },
                {
                    number: 2,
                    ratio: 3.57,
                    gear1Teeth: 28,
                    gear2Teeth: 100,
                    module: 2.5,
                    width: 35,
                    type: 'spur',
                    efficiency: 97.5,
                    actualRatio: 3.57
                }
            ];
            
            updateGearStagesList();
        }
        
        // Initialize with sample loads
        function initializeSampleLoads() {
            shaftLoads = [
                {
                    position: 150,
                    radialLoad: 700,
                    axialLoad: 150,
                    type: 'gear',
                    direction: 'vertical'
                },
                {
                    position: 350,
                    radialLoad: 900,
                    axialLoad: 200,
                    type: 'gear',
                    direction: 'vertical'
                }
            ];
        }
        
        // Single gear calculations
        function calculateSingleGear() {
            const module = parseFloat(document.getElementById('module').value);
            const teeth = parseInt(document.getElementById('teeth').value);
            const pressureAngle = parseFloat(document.getElementById('pressure-angle').value);
            const faceWidth = parseFloat(document.getElementById('face-width').value);
            const rpm = parseFloat(document.getElementById('rpm').value);
            const power = parseFloat(document.getElementById('power').value);
            
            // Gear calculations
            const pitchDiameter = module * teeth;
            const pitchRadius = pitchDiameter / 2;
            const addendum = module;
            const dedendum = module * 1.25;
            const outerDiameter = pitchDiameter + 2 * addendum;
            const rootDiameter = pitchDiameter - 2 * dedendum;
            const circularPitch = Math.PI * module;
            
            // Torque and force calculations
            const torque = (power * 9549) / rpm;
            const tangentialForce = (2 * torque * 1000) / pitchDiameter;
            
            // Stress calculations (simplified)
            const bendingStress = (tangentialForce * module) / (faceWidth * Math.pow(module, 2) * 0.1);
            const contactRatio = 1.5 + Math.random() * 0.5;
            const safetyFactor = 2.0 + Math.random();
            
            // Update UI
            document.getElementById('pitch-diameter').innerHTML = `${pitchDiameter.toFixed(2)}<span class="result-unit">${translations[currentLanguage]["unit.mm"]}</span>`;
            document.getElementById('outer-diameter').innerHTML = `${outerDiameter.toFixed(2)}<span class="result-unit">${translations[currentLanguage]["unit.mm"]}</span>`;
            document.getElementById('tangential-force').innerHTML = `${tangentialForce.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.n"]}</span>`;
            document.getElementById('torque').innerHTML = `${torque.toFixed(2)}<span class="result-unit">${translations[currentLanguage]["unit.nm"]}</span>`;
            document.getElementById('circular-pitch').innerHTML = `${circularPitch.toFixed(2)}<span class="result-unit">${translations[currentLanguage]["unit.mm"]}</span>`;
            document.getElementById('contact-ratio').innerHTML = `${contactRatio.toFixed(2)}<span class="result-unit"></span>`;
            document.getElementById('bending-stress').innerHTML = `${bendingStress.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.mpa"]}</span>`;
            document.getElementById('safety-factor').innerHTML = `${safetyFactor.toFixed(1)}<span class="result-unit"></span>`;
            
            // Draw the gear
            drawSingleGearVisualization(pitchDiameter, outerDiameter, teeth);
        }

        function buildGearStepData() {
            const module = parseFloat(document.getElementById('module').value);
            const teeth = parseInt(document.getElementById('teeth').value);
            const pressureAngle = parseFloat(document.getElementById('pressure-angle').value);
            const faceWidth = parseFloat(document.getElementById('face-width').value);
            const gearTypeKey = `gear-type.${document.getElementById('gear-type').value}`;
            const gearType = translations[currentLanguage][gearTypeKey] || document.getElementById('gear-type').value;

            const pitchDiameter = module * teeth;
            const addendum = module;
            const outerDiameter = pitchDiameter + 2 * addendum;
            const outerRadius = outerDiameter / 2;
            const circularPitch = Math.PI * module;
            const height = Math.max(faceWidth, 1);
            const now = new Date();
            const timestamp = now.toISOString();
            const fileName = `gear-${teeth}t-m${module.toFixed(2)}.stp`;

            const parameterText = [
                `Gear Type=${gearType}`,
                `Module=${module.toFixed(3)} mm`,
                `Teeth=${teeth}`,
                `Pressure Angle=${pressureAngle.toFixed(1)} deg`,
                `Face Width=${faceWidth.toFixed(2)} mm`,
                `Pitch Diameter=${pitchDiameter.toFixed(2)} mm`,
                `Outer Diameter=${outerDiameter.toFixed(2)} mm`,
                `Circular Pitch=${circularPitch.toFixed(2)} mm`
            ].join('; ');

            const content = `ISO-10303-21;
HEADER;
FILE_DESCRIPTION(('Gear STEP export from Gearbox Design System'),'2;1');
FILE_NAME('${fileName}','${timestamp}',('Gearbox Design System'),(''),'', '', '');
FILE_SCHEMA(('AUTOMOTIVE_DESIGN_CC2'));
ENDSEC;
DATA;
#10 = APPLICATION_CONTEXT('mechanical design');
#11 = PRODUCT_CONTEXT('',#10,'mechanical');
#12 = PRODUCT('Gear','Gear','',(#11));
#13 = PRODUCT_DEFINITION_FORMATION_WITH_SPECIFIED_SOURCE('','',#12,.NOT_KNOWN.);
#14 = PRODUCT_DEFINITION('design','',#13,#15);
#15 = PRODUCT_DEFINITION_CONTEXT('part definition',#10,'design');
#16 = PRODUCT_DEFINITION_SHAPE('','',#14);
#17 = (LENGTH_UNIT() NAMED_UNIT(*) SI_UNIT(.MILLI.,.METRE.));
#18 = (PLANE_ANGLE_UNIT() NAMED_UNIT(*) SI_UNIT($,.RADIAN.));
#19 = (SOLID_ANGLE_UNIT() NAMED_UNIT(*) SI_UNIT($,.STERADIAN.));
#20 = UNCERTAINTY_MEASURE_WITH_UNIT(LENGTH_MEASURE(0.01),#17,'distance_accuracy_value','');
#21 = (GEOMETRIC_REPRESENTATION_CONTEXT(3) GLOBAL_UNIT_ASSIGNED_CONTEXT((#17,#18,#19)) GLOBAL_UNCERTAINTY_ASSIGNED_CONTEXT((#20)) REPRESENTATION_CONTEXT('',''));
#22 = CARTESIAN_POINT('',(0.,0.,0.));
#23 = DIRECTION('',(0.,0.,1.));
#24 = DIRECTION('',(1.,0.,0.));
#25 = AXIS2_PLACEMENT_3D('',#22,#23,#24);
#26 = CARTESIAN_POINT('',(0.,0.));
#27 = DIRECTION('',(1.,0.));
#28 = AXIS2_PLACEMENT_2D('',#26,#27);
#29 = CIRCLE_PROFILE_DEF(.AREA.,'',#28,${outerRadius.toFixed(3)});
#30 = EXTRUDED_AREA_SOLID(#29,#25,#23,${height.toFixed(3)});
#31 = SHAPE_REPRESENTATION('Gear body',(#30),#21);
#32 = SHAPE_DEFINITION_REPRESENTATION(#16,#31);
#33 = DESCRIPTIVE_REPRESENTATION_ITEM('Gear parameters','${parameterText}');
#34 = REPRESENTATION('Gear metadata',(#33),#21);
#35 = PROPERTY_DEFINITION('Gear parameters','',#16);
#36 = PROPERTY_DEFINITION_REPRESENTATION(#35,#34);
ENDSEC;
END-ISO-10303-21;
`;

            return { fileName, content };
        }

        function downloadStepFile() {
            const { fileName, content } = buildGearStepData();
            const blob = new Blob([content], { type: 'application/step' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function exportGearToStp() {
            downloadStepFile();
            alert(translations[currentLanguage]["message.export-stp-success"]);
        }
        
        // Draw single gear visualization
        function drawSingleGearVisualization(pitchDiameter, outerDiameter, teeth) {
            singleGearCtx.clearRect(0, 0, singleGearCtx.canvas.width, singleGearCtx.canvas.height);
            
            const centerX = singleGearCtx.canvas.width / 2;
            const centerY = singleGearCtx.canvas.height / 2;
            
            // Scale to fit canvas
            const scale = Math.min(150 / outerDiameter, 2.0);
            const pitchRadius = pitchDiameter / 2 * scale;
            const outerRadius = outerDiameter / 2 * scale;
            
            // Draw gear body
            singleGearCtx.beginPath();
            singleGearCtx.arc(centerX, centerY, outerRadius, 0, Math.PI * 2);
            singleGearCtx.fillStyle = '#e6f2ff';
            singleGearCtx.fill();
            singleGearCtx.strokeStyle = '#4a6491';
            singleGearCtx.lineWidth = 2;
            singleGearCtx.stroke();
            
            // Draw pitch circle
            singleGearCtx.beginPath();
            singleGearCtx.arc(centerX, centerY, pitchRadius, 0, Math.PI * 2);
            singleGearCtx.strokeStyle = '#007bff';
            singleGearCtx.lineWidth = 1.5;
            singleGearCtx.setLineDash([5, 5]);
            singleGearCtx.stroke();
            singleGearCtx.setLineDash([]);
            
            // Draw teeth
            const toothAngle = (2 * Math.PI) / teeth;
            const toothHeight = (outerRadius - pitchRadius) * 1.2;
            const toothWidth = (Math.PI * pitchRadius * 2) / teeth * 0.4;
            
            for (let i = 0; i < teeth; i++) {
                const angle = i * toothAngle;
                const toothX = centerX + pitchRadius * Math.cos(angle);
                const toothY = centerY + pitchRadius * Math.sin(angle);
                
                singleGearCtx.save();
                singleGearCtx.translate(toothX, toothY);
                singleGearCtx.rotate(angle);
                
                singleGearCtx.beginPath();
                singleGearCtx.moveTo(-toothWidth/2, 0);
                singleGearCtx.lineTo(-toothWidth/3, -toothHeight);
                singleGearCtx.lineTo(toothWidth/3, -toothHeight);
                singleGearCtx.lineTo(toothWidth/2, 0);
                singleGearCtx.closePath();
                
                singleGearCtx.fillStyle = '#4a6491';
                singleGearCtx.fill();
                singleGearCtx.strokeStyle = '#2c3e50';
                singleGearCtx.lineWidth = 1;
                singleGearCtx.stroke();
                
                singleGearCtx.restore();
            }
            
            // Draw center hole
            singleGearCtx.beginPath();
            singleGearCtx.arc(centerX, centerY, outerRadius * 0.2, 0, Math.PI * 2);
            singleGearCtx.fillStyle = '#f8fafc';
            singleGearCtx.fill();
            singleGearCtx.strokeStyle = '#4a6491';
            singleGearCtx.lineWidth = 2;
            singleGearCtx.stroke();
            
            // Draw gear info
            singleGearCtx.fillStyle = '#2c3e50';
            singleGearCtx.font = 'bold 16px Arial';
            singleGearCtx.textAlign = 'center';
            singleGearCtx.fillText(`${teeth} ${currentLanguage === 'en' ? 'Tooth Gear' : 'Zahn Zahnrad'}`, centerX, 30);
        }
        
        // Gearbox calculations with service factor
        function calculateGearbox() {
            const inputRPM = parseFloat(document.getElementById('input-rpm').value);
            const inputPower = parseFloat(document.getElementById('input-power').value);
            const totalRatio = parseFloat(document.getElementById('total-ratio').value);
            
            if (gearStages.length === 0) {
                initializeSampleGearStages();
            }
            
            // Calculate overall ratio from stages
            let calculatedRatio = 1;
            gearStages.forEach(stage => {
                calculatedRatio *= stage.actualRatio;
            });
            
            // Update total ratio if needed
            if (Math.abs(calculatedRatio - totalRatio) / totalRatio > 0.05) {
                document.getElementById('total-ratio').value = calculatedRatio.toFixed(2);
            }
            
            // Calculate gearbox service factor
            const gearboxServiceFactor = calculateGearboxServiceFactor();
            
            // Apply service factor to input power (increased load due to service conditions)
            const designPower = inputPower * gearboxServiceFactor;
            
            // Calculate output parameters
            let outputRPM = inputRPM;
            let outputPower = designPower;
            let totalEfficiency = 1;
            let totalCenterDistance = 0;
            
            gearStages.forEach(stage => {
                outputRPM /= stage.actualRatio;
                outputPower *= (stage.efficiency / 100);
                totalEfficiency *= (stage.efficiency / 100);
                
                // Calculate center distance for this stage
                const centerDist = (stage.module * (stage.gear1Teeth + stage.gear2Teeth)) / 2;
                totalCenterDistance += centerDist;
            });
            
            const outputTorque = (outputPower * 9549) / outputRPM;
            const powerLoss = designPower - outputPower;
            const heatGenerated = powerLoss * 1000; // Convert kW to W
            
            // Update UI
            document.getElementById('output-rpm').innerHTML = `${outputRPM.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.rpm"]}</span>`;
            document.getElementById('output-torque').innerHTML = `${outputTorque.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.nm"]}</span>`;
            document.getElementById('gearbox-efficiency').innerHTML = `${(totalEfficiency * 100).toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.percent"]}</span>`;
            document.getElementById('power-loss').innerHTML = `${powerLoss.toFixed(2)}<span class="result-unit">${translations[currentLanguage]["unit.kw"]}</span>`;
            document.getElementById('center-distance').innerHTML = `${totalCenterDistance.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.mm"]}</span>`;
            document.getElementById('overall-size').innerHTML = `${Math.round(totalCenterDistance * 4)}×${Math.round(totalCenterDistance * 2.5)}<span class="result-unit">${translations[currentLanguage]["unit.mm"]}</span>`;
            document.getElementById('gearbox-weight').innerHTML = `${(totalCenterDistance * 0.15).toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.kg"]}</span>`;
            document.getElementById('heat-generated').innerHTML = `${heatGenerated.toFixed(0)}<span class="result-unit">${translations[currentLanguage]["unit.w"]}</span>`;
            
            // Update stage details
            updateStageDetails();
            
            // Draw gearbox
            drawGearbox();
        }
        
        // Update stage details in UI
        function updateStageDetails() {
            stageDetails.innerHTML = '';
            
            if (gearStages.length === 0) {
                stageDetails.innerHTML = `<div class="loading">${translations[currentLanguage]["message.calculate-to-see"]}</div>`;
                return;
            }
            
            gearStages.forEach(stage => {
                const stageDiv = document.createElement('div');
                stageDiv.className = 'gear-stage';
                
                const pitchDiameter1 = stage.module * stage.gear1Teeth;
                const pitchDiameter2 = stage.module * stage.gear2Teeth;
                const centerDistance = (pitchDiameter1 + pitchDiameter2) / 2;
                
                stageDiv.innerHTML = `
                    <div class="stage-header">
                        <div class="stage-title">${translations[currentLanguage]["gearbox.stage"]} ${stage.number}: ${stage.gear1Teeth} / ${stage.gear2Teeth} ${currentLanguage === 'en' ? 'Teeth' : 'Zähne'}</div>
                        <div class="stage-ratio">${stage.actualRatio.toFixed(2)}:1</div>
                    </div>
                    <div class="gear-pair">
                        <div class="gear-pair-item">
                            <div class="gear-icon"><i class="fas fa-cog"></i></div>
                            <div><strong>${currentLanguage === 'en' ? 'Pinion' : 'Ritzel'}</strong></div>
                            <div>${stage.gear1Teeth} ${currentLanguage === 'en' ? 'teeth' : 'Zähne'}</div>
                            <div>Ø${pitchDiameter1.toFixed(1)}mm</div>
                        </div>
                        <div class="gear-pair-item">
                            <i class="fas fa-arrows-alt-h" style="font-size: 24px; color: #64748b;"></i>
                            <div>${currentLanguage === 'en' ? 'Center distance' : 'Achsmittenabstand'}</div>
                            <div>${centerDistance.toFixed(1)}mm</div>
                        </div>
                        <div class="gear-pair-item">
                            <div class="gear-icon"><i class="fas fa-cog"></i></div>
                            <div><strong>${currentLanguage === 'en' ? 'Gear' : 'Rad'}</strong></div>
                            <div>${stage.gear2Teeth} ${currentLanguage === 'en' ? 'teeth' : 'Zähne'}</div>
                            <div>Ø${pitchDiameter2.toFixed(1)}mm</div>
                        </div>
                    </div>
                    <p><strong>${currentLanguage === 'en' ? 'Type' : 'Typ'}:</strong> ${translations[currentLanguage][`gear-type.${stage.type}`]} | <strong>${currentLanguage === 'en' ? 'Module' : 'Modul'}:</strong> ${stage.module}mm | <strong>${currentLanguage === 'en' ? 'Width' : 'Breite'}:</strong> ${stage.width}mm | <strong>${currentLanguage === 'en' ? 'Efficiency' : 'Wirkungsgrad'}:</strong> ${stage.efficiency}%</p>
                `;
                
                stageDetails.appendChild(stageDiv);
            });
        }
        
        // Draw gearbox visualization
        function drawGearbox() {
            gearboxCtx.clearRect(0, 0, gearboxCtx.canvas.width, gearboxCtx.canvas.height);
            
            const centerX = gearboxCtx.canvas.width / 2;
            const centerY = gearboxCtx.canvas.height / 2;
            
            if (gearStages.length === 0) return;
            
            // Draw multiple stages
            const stageSpacing = 150;
            const startX = centerX - ((gearStages.length - 1) * stageSpacing) / 2;
            
            gearStages.forEach((stage, index) => {
                const stageX = startX + index * stageSpacing;
                
                const pitchDiameter1 = stage.module * stage.gear1Teeth;
                const pitchDiameter2 = stage.module * stage.gear2Teeth;
                const scale = Math.min(40 / Math.max(pitchDiameter1, pitchDiameter2), 0.8);
                
                const radius1 = (pitchDiameter1 / 2) * scale;
                const radius2 = (pitchDiameter2 / 2) * scale;
                
                // Draw shaft line
                gearboxCtx.beginPath();
                gearboxCtx.moveTo(stageX - radius1 - 20, centerY);
                gearboxCtx.lineTo(stageX + radius2 + 20, centerY);
                gearboxCtx.strokeStyle = '#94a3b8';
                gearboxCtx.lineWidth = 3;
                gearboxCtx.stroke();
                
                // Draw gear 1 (pinion)
                gearboxCtx.beginPath();
                gearboxCtx.arc(stageX, centerY, radius1, 0, Math.PI * 2);
                gearboxCtx.fillStyle = '#e6f2ff';
                gearboxCtx.fill();
                gearboxCtx.strokeStyle = '#4a6491';
                gearboxCtx.lineWidth = 2;
                gearboxCtx.stroke();
                
                // Draw gear teeth for gear 1
                drawGearTeeth(gearboxCtx, stageX, centerY, radius1, stage.gear1Teeth, '#4a6491');
                
                // Draw gear 2
                gearboxCtx.beginPath();
                gearboxCtx.arc(stageX + radius1 + radius2, centerY, radius2, 0, Math.PI * 2);
                gearboxCtx.fillStyle = '#f0f7ff';
                gearboxCtx.fill();
                gearboxCtx.strokeStyle = '#3a547a';
                gearboxCtx.lineWidth = 2;
                gearboxCtx.stroke();
                
                // Draw gear teeth for gear 2
                drawGearTeeth(gearboxCtx, stageX + radius1 + radius2, centerY, radius2, stage.gear2Teeth, '#3a547a');
                
                // Draw stage label
                gearboxCtx.fillStyle = '#2c3e50';
                gearboxCtx.font = 'bold 14px Arial';
                gearboxCtx.textAlign = 'center';
                gearboxCtx.fillText(`${translations[currentLanguage]["gearbox.stage"]} ${stage.number}`, stageX + (radius1 + radius2)/2, centerY - radius2 - 20);
                
                // Draw ratio
                gearboxCtx.font = '12px Arial';
                gearboxCtx.fillText(`${stage.actualRatio.toFixed(2)}:1`, stageX + (radius1 + radius2)/2, centerY + radius2 + 25);
            });
            
            // Draw input/output arrows
            gearboxCtx.fillStyle = '#4a6491';
            gearboxCtx.font = 'bold 16px Arial';
            gearboxCtx.textAlign = 'center';
            
            // Input arrow and label
            const firstStageX = startX;
            gearboxCtx.fillText(currentLanguage === 'en' ? 'Input' : 'Eingang', firstStageX - 100, centerY - 40);
            drawArrow(gearboxCtx, firstStageX - 120, centerY, firstStageX - 70, centerY);
            
            // Output arrow and label
            const lastStageX = startX + (gearStages.length - 1) * stageSpacing;
            gearboxCtx.fillText(currentLanguage === 'en' ? 'Output' : 'Ausgang', lastStageX + 100, centerY - 40);
            drawArrow(gearboxCtx, lastStageX + 70, centerY, lastStageX + 120, centerY);
            
            // Draw service factor info
            const gearboxServiceFactor = calculateGearboxServiceFactor();
            gearboxCtx.fillStyle = '#1976d2';
            gearboxCtx.font = 'bold 14px Arial';
            gearboxCtx.fillText(`${currentLanguage === 'en' ? 'Service Factor' : 'Betriebsfaktor'}: ${gearboxServiceFactor.toFixed(2)}`, centerX, centerY + 150);
        }
        
        // Draw gear teeth helper function
        function drawGearTeeth(ctx, x, y, radius, teeth, color) {
            const toothAngle = (2 * Math.PI) / teeth;
            const toothHeight = radius * 0.2;
            
            for (let i = 0; i < teeth; i++) {
                const angle = i * toothAngle;
                const toothX = x + radius * Math.cos(angle);
                const toothY = y + radius * Math.sin(angle);
                
                ctx.save();
                ctx.translate(toothX, toothY);
                ctx.rotate(angle);
                
                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.lineTo(-toothHeight/2, -toothHeight);
                ctx.lineTo(toothHeight/2, -toothHeight);
                ctx.closePath();
                
                ctx.fillStyle = color;
                ctx.fill();
                
                ctx.restore();
            }
        }
        
        // Draw arrow helper function
        function drawArrow(ctx, fromX, fromY, toX, toY) {
            const headlen = 10;
            const dx = toX - fromX;
            const dy = toY - fromY;
            const angle = Math.atan2(dy, dx);
            
            ctx.beginPath();
            ctx.moveTo(fromX, fromY);
            ctx.lineTo(toX, toY);
            ctx.strokeStyle = '#4a6491';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headlen * Math.cos(angle - Math.PI/6), toY - headlen * Math.sin(angle - Math.PI/6));
            ctx.lineTo(toX - headlen * Math.cos(angle + Math.PI/6), toY - headlen * Math.sin(angle + Math.PI/6));
            ctx.closePath();
            ctx.fillStyle = '#4a6491';
            ctx.fill();
        }
        
        // Shaft design calculations with material and service factors
        function calculateShaft() {
            // Get geometry parameters
            const shaftLength = parseFloat(document.getElementById('shaft-length').value);
            const shaftDiameter = parseFloat(document.getElementById('shaft-diameter').value);
            const shaftTaper = parseFloat(document.getElementById('shaft-taper').value);
            
            // Get load parameters
            const shaftTorque = parseFloat(document.getElementById('shaft-torque').value);
            const shaftSpeed = parseFloat(document.getElementById('shaft-speed').value);
            const desiredSafety = parseFloat(document.getElementById('desired-safety').value);
            
            // Get material properties
            const material = getCurrentMaterialProperties();
            
            // Calculate service factor
            const serviceFactor = calculateServiceFactor();
            
            // Apply service factor to loads
            const designTorque = shaftTorque * serviceFactor;
            
            // Shaft section properties
            const polarMoment = (Math.PI * Math.pow(shaftDiameter, 4)) / 32; // mm^4
            const areaMoment = (Math.PI * Math.pow(shaftDiameter, 4)) / 64; // mm^4
            const sectionModulus = (Math.PI * Math.pow(shaftDiameter, 3)) / 32; // mm^3
            
            // Torsional stress (pure torsion)
            const torsionalStress = (designTorque * 1000 * shaftDiameter / 2) / polarMoment; // MPa
            
            // Calculate equivalent bending stress from loads
            let maxBendingMoment = 0;
            let totalRadialLoad = 0;
            
            if (shaftLoads.length === 0) {
                initializeSampleLoads();
            }
            
            // Simple beam analysis (simplified)
            shaftLoads.forEach(load => {
                totalRadialLoad += load.radialLoad;
                // Simplified moment calculation
                const moment = load.radialLoad * load.position * (shaftLength - load.position) / shaftLength;
                maxBendingMoment = Math.max(maxBendingMoment, moment);
            });
            
            // If no loads, use a default moment based on torque
            if (maxBendingMoment === 0) {
                maxBendingMoment = designTorque * 1000 * 0.5; // Nmm
            }
            
            const bendingStress = maxBendingMoment / sectionModulus; // MPa
            
            // Von Mises equivalent stress
            const vonMisesStress = Math.sqrt(Math.pow(bendingStress, 2) + 3 * Math.pow(torsionalStress, 2));
            
            // Deflection (simplified cantilever with point load)
            const maxDeflection = (totalRadialLoad * Math.pow(shaftLength, 3)) / (3 * material.elasticModulus * 1000 * areaMoment); // mm
            
            // Critical speed (simplified)
            const shaftMass = material.density * Math.PI * Math.pow(shaftDiameter/1000, 2) * (shaftLength/1000) / 4; // kg (simplified)
            const criticalSpeed = (30 / Math.PI) * Math.sqrt((3 * material.elasticModulus * 1e9 * areaMoment * 1e-12) / (shaftMass * Math.pow(shaftLength/1000, 3)));
            
            // Stiffness
            const torsionalStiffness = (material.elasticModulus * 1e3 * polarMoment) / shaftLength; // Nmm/rad
            const bendingStiffness = (3 * material.elasticModulus * 1e3 * areaMoment) / Math.pow(shaftLength, 3); // N/mm
            
            // Safety factors
            const sfStaticTorsion = material.shearStrength / torsionalStress;
            const sfStaticBending = material.yieldStrength / bendingStress;
            const sfStaticVonMises = material.yieldStrength / vonMisesStress;
            
            // Fatigue safety factor (simplified)
            const enduranceLimit = material.fatigueLimit || (0.5 * material.ultimateStrength);
            const sfFatigue = enduranceLimit / vonMisesStress;
            
            // Stress utilization percentages
            const torsionUtilization = (torsionalStress / material.shearStrength) * 100;
            const bendingUtilization = (bendingStress / material.yieldStrength) * 100;
            const vonMisesUtilization = (vonMisesStress / material.yieldStrength) * 100;
            
            // Determine overall rating
            let overallRating = translations[currentLanguage]["status.safe"];
            let overallRatingText = currentLanguage === 'en' ? 'Excellent' : 'Ausgezeichnet';
            let ratingColor = '#20c997';
            
            if (sfStaticVonMises < desiredSafety) {
                overallRating = currentLanguage === 'en' ? 'Critical' : 'Kritisch';
                overallRatingText = currentLanguage === 'en' ? 'Critical' : 'Kritisch';
                ratingColor = '#dc3545';
            } else if (sfStaticVonMises < desiredSafety * 1.2) {
                overallRating = currentLanguage === 'en' ? 'Warning' : 'Warnung';
                overallRatingText = currentLanguage === 'en' ? 'Marginal' : 'Grenzwertig';
                ratingColor = '#ffc107';
            } else if (sfStaticVonMises < desiredSafety * 1.5) {
                overallRating = translations[currentLanguage]["status.safe"];
                overallRatingText = currentLanguage === 'en' ? 'Good' : 'Gut';
                ratingColor = '#20c997';
            }
            
            // Update UI with results
            document.getElementById('torsional-stress').innerHTML = `${torsionalStress.toFixed(1)}<span class="stress-unit">${translations[currentLanguage]["unit.mpa"]}</span>`;
            document.getElementById('bending-stress').innerHTML = `${bendingStress.toFixed(1)}<span class="stress-unit">${translations[currentLanguage]["unit.mpa"]}</span>`;
            document.getElementById('von-mises-stress').innerHTML = `${vonMisesStress.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.mpa"]}</span>`;
            document.getElementById('max-deflection').innerHTML = `${maxDeflection.toFixed(3)}<span class="result-unit">${translations[currentLanguage]["unit.mm"]}</span>`;
            document.getElementById('critical-speed').innerHTML = `${criticalSpeed.toFixed(0)}<span class="result-unit">${translations[currentLanguage]["unit.rpm"]}</span>`;
            document.getElementById('torsional-stiffness').innerHTML = `${(torsionalStiffness/1000).toFixed(0)}<span class="result-unit">${translations[currentLanguage]["unit.nm-rad"]}</span>`;
            document.getElementById('sf-static').innerHTML = `${sfStaticVonMises.toFixed(1)}<span class="result-unit"></span>`;
            document.getElementById('sf-fatigue').innerHTML = `${sfFatigue.toFixed(1)}<span class="result-unit"></span>`;
            document.getElementById('applied-service-factor').innerHTML = `${serviceFactor.toFixed(2)}<span class="result-unit"></span>`;
            document.getElementById('overall-rating').innerHTML = `${overallRatingText}<span class="result-unit"></span>`;
            document.getElementById('overall-rating').style.color = ratingColor;
            
            // Update stress bars
            document.getElementById('torsion-bar').style.width = `${Math.min(torsionUtilization, 100)}%`;
            document.getElementById('bending-bar').style.width = `${Math.min(bendingUtilization, 100)}%`;
            
            // Update bar colors based on utilization
            document.getElementById('torsion-bar').className = `stress-fill ${torsionUtilization > 80 ? 'critical' : (torsionUtilization > 60 ? 'warning-level' : 'safe')}`;
            document.getElementById('bending-bar').className = `stress-fill ${bendingUtilization > 80 ? 'critical' : (bendingUtilization > 60 ? 'warning-level' : 'safe')}`;
            
            // Update status labels
            const safeText = translations[currentLanguage]["status.safe"];
            document.getElementById('torsion-status').textContent = torsionUtilization > 100 ? 
                (currentLanguage === 'en' ? 'Exceeded!' : 'Überschritten!') : 
                `${safeText} (${torsionUtilization.toFixed(0)}% ${currentLanguage === 'en' ? 'of limit' : 'der Grenze'})`;
            document.getElementById('bending-status').textContent = bendingUtilization > 100 ? 
                (currentLanguage === 'en' ? 'Exceeded!' : 'Überschritten!') : 
                `${safeText} (${bendingUtilization.toFixed(0)}% ${currentLanguage === 'en' ? 'of limit' : 'der Grenze'})`;
            
            // Check for warnings
            let warnings = [];
            let successes = [];
            
            if (sfStaticVonMises < desiredSafety) {
                warnings.push(`${currentLanguage === 'en' ? 'Static safety factor' : 'Statischer Sicherheitsfaktor'} (${sfStaticVonMises.toFixed(1)}) ${currentLanguage === 'en' ? 'is below desired' : 'ist unter dem gewünschten'} (${desiredSafety})`);
            } else {
                successes.push(`${currentLanguage === 'en' ? 'Static safety factor' : 'Statischer Sicherheitsfaktor'} (${sfStaticVonMises.toFixed(1)}) ${currentLanguage === 'en' ? 'meets requirement' : 'erfüllt die Anforderung'} (${desiredSafety})`);
            }
            
            if (sfFatigue < 1.5) {
                warnings.push(`${currentLanguage === 'en' ? 'Fatigue safety factor' : 'Dauerfestigkeits-Sicherheitsfaktor'} (${sfFatigue.toFixed(1)}) ${currentLanguage === 'en' ? 'is below recommended minimum of 1.5' : 'ist unter dem empfohlenen Minimum von 1,5'}`);
            } else {
                successes.push(`${currentLanguage === 'en' ? 'Fatigue safety factor' : 'Dauerfestigkeits-Sicherheitsfaktor'} (${sfFatigue.toFixed(1)}) ${currentLanguage === 'en' ? 'is adequate' : 'ist angemessen'}`);
            }
            
            if (shaftSpeed > criticalSpeed * 0.7) {
                warnings.push(`${currentLanguage === 'en' ? 'Operating speed' : 'Betriebsdrehzahl'} (${shaftSpeed} ${translations[currentLanguage]["unit.rpm"]}) ${currentLanguage === 'en' ? 'is close to critical speed' : 'liegt nahe der kritischen Drehzahl'} (${criticalSpeed.toFixed(0)} ${translations[currentLanguage]["unit.rpm"]})`);
            } else {
                successes.push(`${currentLanguage === 'en' ? 'Critical speed' : 'Kritische Drehzahl'} (${criticalSpeed.toFixed(0)} ${translations[currentLanguage]["unit.rpm"]}) ${currentLanguage === 'en' ? 'is sufficiently higher than operating speed' : 'ist ausreichend höher als die Betriebsdrehzahl'}`);
            }
            
            if (maxDeflection > shaftLength / 2000) {
                warnings.push(`${currentLanguage === 'en' ? 'Deflection' : 'Durchbiegung'} (${maxDeflection.toFixed(3)} ${translations[currentLanguage]["unit.mm"]}) ${currentLanguage === 'en' ? 'may affect gear mesh accuracy' : 'kann die Zahneingriffsgenauigkeit beeinträchtigen'}`);
            } else {
                successes.push(`${currentLanguage === 'en' ? 'Deflection' : 'Durchbiegung'} (${maxDeflection.toFixed(3)} ${translations[currentLanguage]["unit.mm"]}) ${currentLanguage === 'en' ? 'is within acceptable limits' : 'liegt innerhalb akzeptabler Grenzen'}`);
            }
            
            // Display warnings or success
            if (warnings.length > 0) {
                warningText.textContent = warnings.join(' | ');
                shaftWarning.style.display = 'block';
                shaftSuccess.style.display = 'none';
            } else {
                successText.textContent = successes.join(' | ');
                shaftSuccess.style.display = 'block';
                shaftWarning.style.display = 'none';
            }
            
            // Update material summary
            updateMaterialSummary(material, serviceFactor, designTorque);
            
            // Draw shaft
            drawShaft();
        }
        
        // Update material summary
        function updateMaterialSummary(material, serviceFactor, designTorque) {
            const materialName = material.name[currentLanguage] || material.name.en;
            
            materialSummary.innerHTML = `
                <div class="material-props">
                    <div class="material-prop">
                        <span class="prop-name" data-i18n="material.name">Material</span>
                        <span class="prop-value">${materialName}</span>
                    </div>
                    <div class="material-prop">
                        <span class="prop-name" data-i18n="material.yield-strength">Yield Strength</span>
                        <span class="prop-value">${material.yieldStrength} MPa</span>
                    </div>
                    <div class="material-prop">
                        <span class="prop-name" data-i18n="material.shear-strength">Shear Strength</span>
                        <span class="prop-value">${material.shearStrength} MPa</span>
                    </div>
                    <div class="material-prop">
                        <span class="prop-name" data-i18n="service.total-factor">Service Factor Applied</span>
                        <span class="prop-value">${serviceFactor.toFixed(2)}</span>
                    </div>
                    <div class="material-prop">
                        <span class="prop-name" data-i18n="shaft.design-torque">Design Torque</span>
                        <span class="prop-value">${designTorque.toFixed(1)} Nm</span>
                    </div>
                    <div class="material-prop">
                        <span class="prop-name" data-i18n="material.cost-factor">Estimated Cost Factor</span>
                        <span class="prop-value">${material.costFactor ? material.costFactor.toFixed(1) + '×' : 'N/A'}</span>
                    </div>
                </div>
            `;
            
            // Apply translations to the new elements
            switchLanguage(currentLanguage);
        }
        
        // Draw shaft visualization
        function drawShaft() {
            shaftCtx.clearRect(0, 0, shaftCtx.canvas.width, shaftCtx.canvas.height);
            
            const shaftLength = parseFloat(document.getElementById('shaft-length').value);
            const shaftDiameter = parseFloat(document.getElementById('shaft-diameter').value);
            const numBearings = parseInt(document.getElementById('num-bearings').value);
            
            // Scale to fit canvas
            const scaleX = shaftCtx.canvas.width * 0.9 / shaftLength;
            const scaleY = shaftCtx.canvas.height * 0.6 / shaftDiameter;
            const scale = Math.min(scaleX, scaleY);
            
            const centerX = shaftCtx.canvas.width / 2;
            const centerY = shaftCtx.canvas.height / 2;
            
            const displayLength = shaftLength * scale;
            const displayDiameter = shaftDiameter * scale;
            
            // Draw shaft with taper
            const taper = parseFloat(document.getElementById('shaft-taper').value);
            const taperOffset = displayLength * taper;
            
            shaftCtx.beginPath();
            shaftCtx.moveTo(centerX - displayLength/2, centerY - displayDiameter/2);
            shaftCtx.lineTo(centerX + displayLength/2, centerY - displayDiameter/2 + taperOffset);
            shaftCtx.lineTo(centerX + displayLength/2, centerY + displayDiameter/2 - taperOffset);
            shaftCtx.lineTo(centerX - displayLength/2, centerY + displayDiameter/2);
            shaftCtx.closePath();
            
            shaftCtx.fillStyle = '#cbd5e1';
            shaftCtx.fill();
            shaftCtx.strokeStyle = '#475569';
            shaftCtx.lineWidth = 2;
            shaftCtx.stroke();
            
            // Draw bearings
            for (let i = 0; i < numBearings; i++) {
                const bearingX = centerX - displayLength/2 + (i + 1) * displayLength / (numBearings + 1);
                
                // Draw bearing
                shaftCtx.beginPath();
                shaftCtx.arc(bearingX, centerY, displayDiameter * 0.8, 0, Math.PI * 2);
                shaftCtx.fillStyle = '#f8fafc';
                shaftCtx.fill();
                shaftCtx.strokeStyle = '#4a6491';
                shaftCtx.lineWidth = 2;
                shaftCtx.stroke();
                
                // Draw bearing label
                shaftCtx.fillStyle = '#2c3e50';
                shaftCtx.font = '12px Arial';
                shaftCtx.textAlign = 'center';
                shaftCtx.fillText(currentLanguage === 'en' ? 'Bearing' : 'Lager', bearingX, centerY - displayDiameter);
            }
            
            // Draw load points
            if (shaftLoads.length === 0) {
                initializeSampleLoads();
            }
            
            shaftLoads.forEach((load, index) => {
                const loadX = centerX - displayLength/2 + load.position * scale;
                const loadY = centerY - displayDiameter * 1.5;
                
                // Draw load arrow
                shaftCtx.beginPath();
                shaftCtx.moveTo(loadX, loadY);
                shaftCtx.lineTo(loadX, centerY - displayDiameter/2);
                shaftCtx.strokeStyle = '#dc2626';
                shaftCtx.lineWidth = 2;
                shaftCtx.stroke();
                
                // Draw arrow head
                shaftCtx.beginPath();
                shaftCtx.moveTo(loadX, centerY - displayDiameter/2);
                shaftCtx.lineTo(loadX - 5, centerY - displayDiameter/2 + 10);
                shaftCtx.lineTo(loadX + 5, centerY - displayDiameter/2 + 10);
                shaftCtx.closePath();
                shaftCtx.fillStyle = '#dc2626';
                shaftCtx.fill();
                
                // Draw load label
                shaftCtx.fillStyle = '#dc2626';
                shaftCtx.font = 'bold 12px Arial';
                shaftCtx.textAlign = 'center';
                shaftCtx.fillText(`${load.radialLoad}N`, loadX, loadY - 10);
            });
            
            // Draw torque arrow
            shaftCtx.beginPath();
            shaftCtx.arc(centerX + displayLength/2 + 30, centerY, 15, 0, Math.PI * 2);
            shaftCtx.strokeStyle = '#4a6491';
            shaftCtx.lineWidth = 3;
            shaftCtx.stroke();
            
            // Draw torque direction arrow
            shaftCtx.beginPath();
            shaftCtx.moveTo(centerX + displayLength/2 + 45, centerY);
            shaftCtx.lineTo(centerX + displayLength/2 + 30, centerY - 10);
            shaftCtx.lineTo(centerX + displayLength/2 + 30, centerY + 10);
            shaftCtx.closePath();
            shaftCtx.fillStyle = '#4a6491';
            shaftCtx.fill();
            
            // Draw shaft info
            shaftCtx.fillStyle = '#2c3e50';
            shaftCtx.font = 'bold 16px Arial';
            shaftCtx.textAlign = 'center';
            shaftCtx.fillText(currentLanguage === 'en' ? 'Shaft Design' : 'Wellenauslegung', centerX, 30);
            
            const material = getCurrentMaterialProperties();
            const materialName = material.name[currentLanguage] || material.name.en;
            shaftCtx.font = '14px Arial';
            shaftCtx.fillText(`${materialName} | Ø${shaftDiameter}mm × ${shaftLength}mm`, centerX, 55);
        }
        
        // Draw analysis visualization
        function drawAnalysis() {
            analysisCtx.clearRect(0, 0, analysisCtx.canvas.width, analysisCtx.canvas.height);
            
            const centerX = analysisCtx.canvas.width / 2;
            const centerY = analysisCtx.canvas.height / 2;
            
            // Draw a simplified system diagram
            analysisCtx.fillStyle = '#2c3e50';
            analysisCtx.font = 'bold 18px Arial';
            analysisCtx.textAlign = 'center';
            analysisCtx.fillText(currentLanguage === 'en' ? 'Complete System Analysis' : 'Komplette Systemanalyse', centerX, 40);
            
            // Draw system schematic
            const radius = 100;
            
            // Draw input
            analysisCtx.beginPath();
            analysisCtx.arc(centerX - 150, centerY, 30, 0, Math.PI * 2);
            analysisCtx.fillStyle = '#4a6491';
            analysisCtx.fill();
            analysisCtx.fillStyle = 'white';
            analysisCtx.font = 'bold 14px Arial';
            analysisCtx.fillText(currentLanguage === 'en' ? 'IN' : 'EIN', centerX - 150, centerY + 5);
            
            // Draw gearbox
            analysisCtx.fillStyle = '#e6f2ff';
            analysisCtx.fillRect(centerX - 100, centerY - 60, 120, 120);
            analysisCtx.strokeStyle = '#4a6491';
            analysisCtx.lineWidth = 3;
            analysisCtx.strokeRect(centerX - 100, centerY - 60, 120, 120);
            
            analysisCtx.fillStyle = '#2c3e50';
            analysisCtx.font = 'bold 14px Arial';
            analysisCtx.fillText(currentLanguage === 'en' ? 'GEARBOX' : 'GETRIEBE', centerX - 40, centerY);
            
            // Draw shafts
            analysisCtx.beginPath();
            analysisCtx.moveTo(centerX - 150, centerY);
            analysisCtx.lineTo(centerX - 100, centerY);
            analysisCtx.moveTo(centerX + 20, centerY);
            analysisCtx.lineTo(centerX + 100, centerY);
            analysisCtx.strokeStyle = '#94a3b8';
            analysisCtx.lineWidth = 4;
            analysisCtx.stroke();
            
            // Draw output
            analysisCtx.beginPath();
            analysisCtx.arc(centerX + 150, centerY, 30, 0, Math.PI * 2);
            analysisCtx.fillStyle = '#10b981';
            analysisCtx.fill();
            analysisCtx.fillStyle = 'white';
            analysisCtx.font = 'bold 14px Arial';
            analysisCtx.fillText(currentLanguage === 'en' ? 'OUT' : 'AUS', centerX + 150, centerY + 5);
            
            // Draw efficiency bars
            const efficiency = 91.2; // From calculations
            
            analysisCtx.fillStyle = '#e2e8f0';
            analysisCtx.fillRect(centerX - 50, centerY + 80, 100, 20);
            
            analysisCtx.fillStyle = efficiency > 90 ? '#10b981' : (efficiency > 80 ? '#f59e0b' : '#dc2626');
            analysisCtx.fillRect(centerX - 50, centerY + 80, efficiency, 20);
            
            analysisCtx.fillStyle = '#2c3e50';
            analysisCtx.font = '14px Arial';
            analysisCtx.fillText(`${currentLanguage === 'en' ? 'Efficiency' : 'Wirkungsgrad'}: ${efficiency}%`, centerX, centerY + 95);
            
            // Draw status indicators
            const statusY = centerY + 130;
            
            // Gearbox status
            analysisCtx.beginPath();
            analysisCtx.arc(centerX - 60, statusY, 8, 0, Math.PI * 2);
            analysisCtx.fillStyle = '#10b981';
            analysisCtx.fill();
            analysisCtx.fillStyle = '#2c3e50';
            analysisCtx.font = '12px Arial';
            analysisCtx.fillText(currentLanguage === 'en' ? 'Gearbox OK' : 'Getriebe OK', centerX - 60, statusY + 20);
            
            // Shaft status
            analysisCtx.beginPath();
            analysisCtx.arc(centerX, statusY, 8, 0, Math.PI * 2);
            analysisCtx.fillStyle = '#10b981';
            analysisCtx.fill();
            analysisCtx.fillStyle = '#2c3e50';
            analysisCtx.fillText(currentLanguage === 'en' ? 'Shafts OK' : 'Wellen OK', centerX, statusY + 20);
            
            // Bearing status
            analysisCtx.beginPath();
            analysisCtx.arc(centerX + 60, statusY, 8, 0, Math.PI * 2);
            analysisCtx.fillStyle = '#f59e0b';
            analysisCtx.fill();
            analysisCtx.fillStyle = '#2c3e50';
            analysisCtx.fillText(currentLanguage === 'en' ? 'Check Bearings' : 'Lager prüfen', centerX + 60, statusY + 20);
        }
        
        // Initialize sample data
        function initializeSampleData() {
            initializeSampleGearStages();
            initializeSampleLoads();
            updateMaterialProperties();
            calculateServiceFactor();
            calculateGearboxServiceFactor();
            calculateSingleGear();
            calculateGearbox();
            calculateShaft();
            drawAnalysis();
        }
        
        // Event listeners for calculate buttons
        document.getElementById('calculate-single').addEventListener('click', calculateSingleGear);
        document.getElementById('export-gear-stp').addEventListener('click', exportGearToStp);
        document.getElementById('reset-single').addEventListener('click', function() {
            document.getElementById('module').value = 3;
            document.getElementById('teeth').value = 24;
            document.getElementById('pressure-angle').value = 20;
            document.getElementById('face-width').value = 25;
            document.getElementById('rpm').value = 1200;
            document.getElementById('power').value = 7.5;
            calculateSingleGear();
        });
        
        document.getElementById('calculate-gearbox').addEventListener('click', calculateGearbox);
        document.getElementById('reset-gearbox').addEventListener('click', function() {
            gearStages = [];
            document.getElementById('input-rpm').value = 1500;
            document.getElementById('input-power').value = 10;
            document.getElementById('total-ratio').value = 12.5;
            document.getElementById('module-gearbox').value = 2.5;
            updateGearStagesList();
            calculateGearbox();
        });
        
        document.getElementById('calculate-shaft').addEventListener('click', calculateShaft);
        document.getElementById('reset-shaft').addEventListener('click', function() {
            document.getElementById('shaft-length').value = 500;
            document.getElementById('shaft-diameter').value = 40;
            document.getElementById('shaft-taper').value = 0.05;
            document.getElementById('shaft-torque').value = 200;
            document.getElementById('shaft-speed').value = 1200;
            document.getElementById('desired-safety').value = 2.5;
            initializeSampleLoads();
            calculateShaft();
        });
        
        document.getElementById('run-analysis').addEventListener('click', function() {
            // Run all calculations
            calculateSingleGear();
            calculateGearbox();
            calculateShaft();
            drawAnalysis();
            
            // Update analysis results with calculated values
            const efficiency = parseFloat(document.getElementById('gearbox-efficiency').textContent);
            const powerLoss = parseFloat(document.getElementById('power-loss').textContent);
            
            document.getElementById('total-efficiency').innerHTML = `${efficiency.toFixed(1)}<span class="result-unit">${translations[currentLanguage]["unit.percent"]}</span>`;
            document.getElementById('total-power-loss').innerHTML = `${powerLoss.toFixed(2)}<span class="result-unit">${translations[currentLanguage]["unit.kw"]}</span>`;
            document.getElementById('total-heat').innerHTML = `${(powerLoss * 1000).toFixed(0)}<span class="result-unit">${translations[currentLanguage]["unit.w"]}</span>`;
            
            // Show success message
            alert(currentLanguage === 'en' 
                ? 'Complete system analysis has been performed. All components have been checked.' 
                : 'Komplette Systemanalyse wurde durchgeführt. Alle Komponenten wurden geprüft.');
        });
        
        // Event listeners for custom material inputs
        document.querySelectorAll('#custom-material-section input').forEach(input => {
            input.addEventListener('input', updateCustomMaterialProperties);
        });
        
        // Event listeners for service factor inputs (both shaft and gearbox)
        document.querySelectorAll('.service-factors select, .gearbox-service-factors select').forEach(select => {
            select.addEventListener('change', function() {
                if (this.closest('.gearbox-service-factors')) {
                    calculateGearboxServiceFactor();
                    if (currentTab === 'gearbox') {
                        calculateGearbox();
                    }
                } else {
                    calculateServiceFactor();
                    if (currentTab === 'shaft') {
                        calculateShaft();
                    }
                }
            });
        });
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeSampleData();
            switchLanguage('en'); // Start with English
        });
    </script>
</body>
</html>
